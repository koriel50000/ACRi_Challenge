#include "kernel.hpp"
#include <ap_int.h>
#include <hls_stream.h>
#include <hls_math.h>

#define I28(hex) int2x28_t("0x" hex, 16)
#define I64(hex) int2x64_t("0x" hex, 16)

const int W = 28;
const int H = 28;

const int FL = 64;
const int CL = 10;

using int2_t = ap_int<2>;
using uint2_t = ap_uint<2>;
using int2x28_t = ap_uint<2 * 28>;
using int2x64_t = ap_uint<2 * 64>;
template <class C>
using fifo = hls::stream<C>;

namespace bit {
	template <int S>
	int2_t get(const ap_uint<2 * S>& src, const int idx) {
#pragma HLS inline
		int p = 2 * idx;
		return src(p + 2 - 1, p);
	}

	template <int S>
	void set(ap_uint<2 * S>& src, const int idx, const int2_t& v) {
#pragma HLS inline
		int p = 2 * idx;
		src(p + 2 - 1, p) = v;
	}

	template <int S>
	uint2_t getu(const ap_uint<2 * S>& src, const int idx) {
#pragma HLS inline
		int p = 2 * idx;
		return src(p + 2 - 1, p);
	}

	template <int S>
	void setu(ap_uint<2 * S>& src, const int idx, const uint2_t& v) {
#pragma HLS inline
		int p = 2 * idx;
		src(p + 2 - 1, p) = v;
	}

	// @see HD, Figure 3-3
	constexpr int clp2(int x) {
		x = x - 1;
		x = x | (x >> 1);
		x = x | (x >> 2);
		x = x | (x >> 4);
		x = x | (x >> 8);
		x = x | (x >> 16);
		return x + 1;
	}

	template <int S>
	int16_t multiply_add(ap_uint<2 * S>& vi, ap_uint<2 * S>& wi) {
		const int M = clp2(S);
		int16_t t[M];
#pragma HLS array_partition variable=t

		for (int i = 0; i < S; i++) {
#pragma HLS unroll
			int2_t v = get<S>(vi, i);
			int2_t w = get<S>(wi, i);
			t[i] = v * w;
		}
		for (int i = S; i < M; i++) {
#pragma HLS unroll
			t[i] = 0;
		}

		for (int d = 1; d < M; d *= 2) {
#pragma HLS pipeline
			for (int i = 0; i < M; i += d * 2) {
#pragma HLS unroll
				t[i] += t[i + d];
			}
		}
		return t[0];
	}
} // namespace bit

// Brevitasで学習した2bit重みを利用
// https://github.com/Xilinx/brevitas/
//
// bnn_pynq/cfg/fc_2w2a.ini
// [MODEL]
// ARCH: FC
// DATASET: MNIST
// IN_CHANNELS: 1
// OUT_FEATURES = [64, 64]
// NUM_CLASSES: 10
// [QUANT]
// WEIGHT_BIT_WIDTH: 2
// ACT_BIT_WIDTH: 2
// IN_BIT_WIDTH: 1
//
// @FIXME 認識率が安定しないので中間層を2層にしてみたが
// 今度は認識率が悪くなってしまった。
// バッチ正規化の補正をいれて何とか90%をクリアできる状態。
//
void affine1(fifo<int2x28_t>& ins, fifo<int2x64_t>& outs) {
	static int2x28_t w1[H * FL] = {
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00001001000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000301000000"),I28("00000100000000"),
I28("00000000000000"),I28("00004000000000"),I28("00000001100000"),I28("00000000000000"),
I28("00000cc0000000"),I28("0033ffc0000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000051000000"),I28("00000155040000"),I28("00000000000000"),
I28("00000fff000000"),I28("00000555000000"),I28("000000c0000000"),I28("00000000000000"),
I28("0000c3ccc00000"),I28("00000000000000"),I28("00000300000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("0000000f000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00055010400000"),I28("00000055000000"),
I28("00000000000000"),I28("00000000000000"),I28("0000033ffc0000"),I28("00000100000000"),
I28("00000000000000"),I28("00000000000000"),I28("00014040cc0000"),I28("00000001400000"),
I28("00000014000000"),I28("00000000000000"),I28("00000001400000"),I28("00000000000000"),
I28("00000000000000"),I28("00000100000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000300000000"),I28("00000000000000"),I28("00055101000000"),I28("00000000000000"),
I28("00001450000000"),I28("0000003c000000"),I28("00114400000000"),I28("00000000000000"),
I28("00115450000000"),I28("00003c3fc30000"),I28("00000c30000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000155500000"),I28("00000100000000"),
I28("00050300000000"),I28("0000fcc1000000"),I28("00040ff0544000"),I28("0000f003c00000"),
I28("00005103000000"),I28("0005504c000000"),I28("00000055555000"),I28("00305500000000"),
I28("00040fc0000000"),I28("00ffffc0000000"),I28("00000504000000"),I28("003ffc3f000000"),
I28("000c0550300000"),I28("00005554400000"),I28("00010555550000"),I28("000503c0000000"),
I28("00003fffcc0000"),I28("01555555500000"),I28("0000f111000000"),I28("00040003c00000"),
I28("0333300c3c0000"),I28("0000303c000000"),I28("00005330c00000"),I28("0000000ff00000"),
I28("000003ffc00000"),I28("00001415400000"),I28("00004503000000"),I28("000000f3000000"),
I28("00005401500000"),I28("00000155500000"),I28("00151140500000"),I28("003c5550000000"),
I28("00015550510000"),I28("00000040440000"),I28("003c300c000000"),I28("00050403f00000"),
I28("00055415400000"),I28("0000000fc00000"),I28("0004033ff00000"),I28("0000c030440000"),
I28("00014555400000"),I28("0000030c000000"),I28("00000051000000"),I28("0001554ff00000"),
I28("00005440000000"),I28("00100155440000"),I28("000003fc000000"),I28("0011403c000000"),
I28("000003c0100000"),I28("00000c05400000"),I28("00155555440000"),I28("00001100000000"),
I28("00041404400000"),I28("000150fc000000"),I28("0054103f000000"),I28("00000041000000"),
I28("0115540c000000"),I28("000fffffffc000"),I28("00ff033f300000"),I28("00000540550000"),
I28("00000440000000"),I28("00003fff0c0000"),I28("000f0155540000"),I28("01415554410000"),
I28("00155030000000"),I28("003f0501c00000"),I28("0110ff05550000"),I28("000c0013ff0000"),
I28("00055553000000"),I28("000533333c0000"),I28("00115115414000"),I28("0001554f0c0000"),
I28("005550ff040000"),I28("000cf0f00c0000"),I28("00000450300000"),I28("003ffffff00000"),
I28("033045543cc000"),I28("000c5550c00000"),I28("00331555554000"),I28("001500c0004000"),
I28("01553cffffc000"),I28("00555555544000"),I28("01303d00400000"),I28("00140033f00000"),
I28("03f0c300500000"),I28("00400030010000"),I28("01400cc0000000"),I28("03c300033f0000"),
I28("00003c0c000000"),I28("00001315400000"),I28("00010153c0c000"),I28("00043fccff0000"),
I28("00010114110000"),I28("00001555544000"),I28("005400cf000000"),I28("00ffc550c00000"),
I28("00015001145000"),I28("003cc110000000"),I28("00f3cf10440000"),I28("00004000ffc000"),
I28("000000ff3c0000"),I28("0110054cf30000"),I28("005453fffcc000"),I28("00000301110000"),
I28("01033304040000"),I28("003fc007000000"),I28("0000155c3c0000"),I28("000555ff300c00"),
I28("00300000000000"),I28("00001511550000"),I28("000000ff100000"),I28("004430ff000000"),
I28("0001540c000000"),I28("0004c045514000"),I28("03f55400000000"),I28("00010545100000"),
I28("00155410030000"),I28("00003c3ffc0000"),I28("01400330f00000"),I28("00004000540000"),
I28("005544ff000000"),I28("00fffffffff000"),I28("003c01543f3000"),I28("00001001540000"),
I28("01031000014000"),I28("005511fffc0000"),I28("00cc1040403000"),I28("01445451100000"),
I28("0005703000c000"),I28("00c001133fc000"),I28("0100fc55140000"),I28("000101554f0000"),
I28("00541443500000"),I28("0040433ff31400"),I28("00055553dc0000"),I28("000554c00ccc00"),
I28("014033ffc00000"),I28("00000410000000"),I28("00003004000000"),I28("00cffffffc0000"),
I28("00c00550fff000"),I28("00c0550cc44000"),I28("00c01555504000"),I28("0055ff04400000"),
I28("0055153ff3c000"),I28("0c045110550000"),I28("0400fc40400000"),I28("001540c3f3f000"),
I28("00030445000000"),I28("0050f730000000"),I28("014303f0010000"),I28("00f3154433c000"),
I28("000003c3000000"),I28("003c53154fcc00"),I28("00304013fc0000"),I28("014003c03ff000"),
I28("00150555555000"),I28("00015555555400"),I28("00040f30004000"),I28("00fffc3cc00000"),
I28("00330c14055000"),I28("00cff550cc0000"),I28("030cc0f3154000"),I28("00010c44fff000"),
I28("003ffffff30000"),I28("0050054300c000"),I28("005410cfff0000"),I28("0003f004500000"),
I28("00001447000000"),I28("000c0010c40000"),I28("00315503cfc000"),I28("0015540300c000"),
I28("033ffffffc0000"),I28("03000001554000"),I28("000cffff000000"),I28("0004fffff00000"),
I28("0c0015fc700000"),I28("01400000551000"),I28("03ff03f3f00000"),I28("00055545000000"),
I28("0155410003f000"),I28("0100fffcf00000"),I28("01cffffff10000"),I28("00001541414000"),
I28("01514000000000"),I28("003ffffffff000"),I28("00000557fff000"),I28("00000041555000"),
I28("05441010004400"),I28("0151555f0c1000"),I28("00000054440000"),I28("00455545140000"),
I28("000000700c0000"),I28("0505155500f000"),I28("0043fd554f0000"),I28("00044105540000"),
I28("00554400100300"),I28("0040307f041500"),I28("003c3c0ff3f000"),I28("001555410c30c0"),
I28("0f0503ff1c0000"),I28("01143305000000"),I28("000d101003cc00"),I28("00f0154fff0000"),
I28("0fc1554003ff00"),I28("00c557fcc10400"),I28("00005144000000"),I28("0155ff15300c00"),
I28("015443ffcff000"),I28("0fc3c330444000"),I28("01403f00510000"),I28("0000440ffff000"),
I28("00041000fff000"),I28("000301c0300000"),I28("050003c1001000"),I28("3fc0553c0fc000"),
I28("00000dc0000000"),I28("000c0f553ff000"),I28("00030403f0c000"),I28("01503fc14ffc00"),
I28("01503ff3555000"),I28("001500f0c04400"),I28("0fc051555c0000"),I28("013ffd43030000"),
I28("03fc0114115540"),I28("03ff1557000300"),I28("01000455155400"),I28("000000143ff000"),
I28("030ffcf3300000"),I28("0110050c000000"),I28("0045000fffc000"),I28("000040cc004400"),
I28("0003404c304000"),I28("0003c053c00400"),I28("0001553c333000"),I28("0015433fc03000"),
I28("003ffffff00400"),I28("0fc04440555000"),I28("0033c033414000"),I28("010c3ffc454000"),
I28("0000553c000000"),I28("00010514040400"),I28("03ffffffff0100"),I28("04004004000000"),
I28("15555545503000"),I28("010014f3c00000"),I28("040c3fffc1f000"),I28("00110101400000"),
I28("0140ffff015000"),I28("010ffffffcf000"),I28("03f0150c03f000"),I28("03cc0145550000"),
I28("01111001040000"),I28("01554455551000"),I28("000ffc55403000"),I28("00c05555150000"),
I28("013f033d300000"),I28("00055555550000"),I28("014ffd55f3ffc0"),I28("00504005555000"),
I28("00015571540f00"),I28("00401753cf0040"),I28("03fffffccfc000"),I28("00555004503000"),
I28("0f055530403000"),I28("00540305440000"),I28("0cf0045457cf00"),I28("01055555fff000"),
I28("0fc1554f30ff00"),I28("03d553ff004000"),I28("0105c04c30c000"),I28("01553f5540ff00"),
I28("00500fff010000"),I28("0fc033c1104400"),I28("05053311004000"),I28("0ffff0fffc3c00"),
I28("000700f33ffc00"),I28("000f31433fc000"),I28("00314c00cd0000"),I28("03c4554fcf0000"),
I28("15001011050000"),I28("0003f3557ffc00"),I28("0c001453fc0000"),I28("01430ff157fc00"),
I28("0140ffffc54400"),I28("01503fffff0000"),I28("0ffc1555501000"),I28("000ffd5c030000"),
I28("0fffc155f05500"),I28("04f0c55703c000"),I28("01455540555000"),I28("005005510ff000"),
I28("0ffcc00cc00000"),I28("010f0503000000"),I28("01104010ffc000"),I28("00f0fff3044000"),
I28("0fcc1313f30000"),I28("0040cc03c01400"),I28("001557fff00000"),I28("00555003110300"),
I28("05400cff041000"),I28("3fc01154155000"),I28("00c00400150000"),I28("0030fff0054400"),
I28("00c0553c001400"),I28("01104455511400"),I28("0ffffffffc0000"),I28("000013400d0000"),
I28("05555555500c00"),I28("00115550f34000"),I28("0555547055f000"),I28("00004113000400"),
I28("000fffffc10000"),I28("00543fffffcc00"),I28("0331553cf03c00"),I28("00c04555555400"),
I28("00050140030500"),I28("00411555105400"),I28("00ffff15500c00"),I28("00fff555514000"),
I28("0030c0f0f30100"),I28("01555555555000"),I28("0143fc54cf3300"),I28("01545551555500"),
I28("0c001055510300"),I28("00415555fc0000"),I28("0ffffff3303c00"),I28("00155ff0c00f00"),
I28("0fc4403cc43000"),I28("00555555004000"),I28("03f0d013033300"),I28("054055554ff000"),
I28("0fd1557ff00fc0"),I28("005540fff4f000"),I28("00000d40c000c0"),I28("01553fd541ffc0"),
I28("0150cfff555500"),I28("3fffc301444500"),I28("0540cf15014000"),I28("0ffffffff00f00"),
I28("0001140cff0c00"),I28("0030f05fffc000"),I28("05043000031500"),I28("0f735103f3c000"),
I28("05010103500400"),I28("0015cf157ff000"),I28("0070c10cff0000"),I28("0103f3f157ff00"),
I28("01440ffc015400"),I28("01530ffff03000"),I28("0ffc0555511000"),I28("3003ff54000000"),
I28("0ff00157fc1540"),I28("05ff35533ffc00"),I28("0555550f555500"),I28("0043fd50cff000"),
I28("03cff07004c000"),I28("0503c57007c000"),I28("01504fc57fc000"),I28("00c3f3c04c0c00"),
I28("3fc0310003f000"),I28("00414c17c30000"),I28("05555ffff14c00"),I28("00557ffd410300"),
I28("05555505554000"),I28("0f03c100555400"),I28("00fc070f700000"),I28("0503ffc5555500"),
I28("000315ff051400"),I28("003f055030c000"),I28("0fffffffc14500"),I28("04447000c30000"),
I28("0fffc555500000"),I28("04555554f34000"),I28("00151531540000"),I28("0f100333440000"),
I28("03003fff304000"),I28("01455504003000"),I28("0fc154f0051000"),I28("03100555540000"),
I28("03f3ccd5010000"),I28("00105145150000"),I28("03ffffc551cc00"),I28("03ffff55554000"),
I28("01503ff00c0100"),I28("00001555555400"),I28("00443f57ffc000"),I28("1551055c415500"),
I28("0ffffff5550000"),I28("0f000055ff0c00"),I28("0ffffffc3c0000"),I28("001513fc040f00"),
I28("0cc0153fc03300"),I28("01455555414000"),I28("030c03c0c303c0"),I28("0550155554fc00"),
I28("0f15557ffc0f00"),I28("0055fcfffffc00"),I28("01000c0fc00000"),I28("00557ff55003c0"),
I28("0150cff1455400"),I28("0ff33154500400"),I28("050c3f04400000"),I28("0003ffff151000"),
I28("05055550034000"),I28("00333f5400c300"),I28("0404303cf11400"),I28("0f014fd4300c00"),
I28("0030ff14000100"),I28("01410fc57fff00"),I28("0ff03d3053f000"),I28("010003f554fc00"),
I28("004543ff00f000"),I28("005000fffff000"),I28("3ff00055455400"),I28("0001ff110c0000"),
I28("0fc45557ffc540"),I28("050ff157f003c0"),I28("055555c1550500"),I28("00ffff501ffc00"),
I28("0fff00c1ccf000"),I28("0573f550000000"),I28("0103fc057ff000"),I28("03fcc3c0400000"),
I28("03cfc003ff0000"),I28("01555457f33500"),I28("01557fff001000"),I28("00555ffc550f00"),
I28("05545555551000"),I28("0fc0ffc0554000"),I28("00fc047c000000"),I28("04cfff15555400"),
I28("0330057f045000"),I28("0fcff00fcc0000"),I28("00cffc55555500"),I28("05441c13000000"),
I28("0fffffc0400000"),I28("055555570cf000"),I28("000003f1554000"),I28("0fc0ff3c540000"),
I28("03f3f3ffc14000"),I28("01045545500000"),I28("0fc554f3001000"),I28("0000333ffff000"),
I28("03ffff3c000000"),I28("005050c1051400"),I28("003303fc500000"),I28("00fffffc554000"),
I28("05550fc5404000"),I28("01443fc5555500"),I28("00103f55330c00"),I28("01455554c10040"),
I28("0ffffffd541000"),I28("0f0151553fc000"),I28("003fffc5000000"),I28("003557ff041300"),
I28("0301554fd14000"),I28("00105555000000"),I28("000c0f0fff3300"),I28("15511515500c00"),
I28("0c55557ffff000"),I28("0154ff303fff00"),I28("004cffd7001000"),I28("00554ffd554300"),
I28("050033c5544100"),I28("0f003155301000"),I28("1553c054005000"),I28("0050fff1555500"),
I28("00151554455400"),I28("0cffffd5551000"),I28("040cf540c04400"),I28("0c554fd5400000"),
I28("03fffffffc4040"),I28("00400ff53c0330"),I28("0ff3000115fc00"),I28("0000c3f554ff00"),
I28("000004ff03f100"),I28("0040043ffffc00"),I28("0c00ffd5541000"),I28("03003fd4717000"),
I28("0f015543fff100"),I28("040ffd5fc00300"),I28("055555f1551500"),I28("03ffffd513fcc0"),
I28("0ff00401000000"),I28("0573fd55033300"),I28("044ffc054ff000"),I28("03f000f133c000"),
I28("03cc0c033fcc00"),I28("05555554ff1100"),I28("01557ffc550400"),I28("00155ffc154000"),
I28("05455555440440"),I28("0ff30fff155000"),I28("00cc057fc0f100"),I28("033fff55555100"),
I28("0010057fc01300"),I28("00fcf3fffcc000"),I28("0151d055554540"),I28("05550f0c004000"),
I28("0fffffff300000"),I28("150555530cfc00"),I28("0fc3ccc5555000"),I28("0ffc000141fc00"),
I28("0cc37cffc50000"),I28("05405155545f00"),I28("0fc555fc000000"),I28("00c000fffffc00"),
I28("03fff0d3ffc000"),I28("001543f5510000"),I28("004533ff555400"),I28("00fc07ffc00000"),
I28("015544d5505000"),I28("014103fc540400"),I28("00143f55554000"),I28("05500555400000"),
I28("0fffffff141000"),I28("0f0001557fc000"),I28("01430013ff3000"),I28("003055ff010000"),
I28("00155553104000"),I28("0013f0f3ff3f00"),I28("05000153fcff00"),I28("05555c05555000"),
I28("0155503fccf000"),I28("0154fcf15cff30"),I28("004fcfc40c0400"),I28("001553fc454400"),
I28("003f0cc5403000"),I28("0f011155430140"),I28("00c0c555514100"),I28("00151155555500"),
I28("00115715515100"),I28("030003f5555500"),I28("00ff0540011000"),I28("0155ffc3c14000"),
I28("03fffffffff040"),I28("001443d54cc300"),I28("0ff15411553f00"),I28("004303f553fc00"),
I28("000cc1fdffff00"),I28("0003cf15540000"),I28("01504315511500"),I28("0f5503c4000000"),
I28("331555fffff040"),I28("00c0fd57f00000"),I28("015557f1555140"),I28("03ffffc554ffc0"),
I28("0ff11501104f00"),I28("053fff5540c300"),I28("00fffc055ffc00"),I28("03c040fcf01500"),
I28("3c073cfc3cc000"),I28("00044f55ffc000"),I28("00557ff1155500"),I28("001557fc155000"),
I28("05001555540110"),I28("03cc0ffc551400"),I28("03c0055fff0000"),I28("00f3fd55514500"),
I28("0011055fc13f00"),I28("03ff00ffffcc00"),I28("01405155440510"),I28("0554ffd7c31400"),
I28("0ffffffffc0300"),I28("0033ffcffcff00"),I28("0313fff5455400"),I28("0ffc115550fc00"),
I28("010c3cfc540000"),I28("00cd1571555000"),I28("03d5553f000400"),I28("00cc00ffffff00"),
I28("03ffc05540c000"),I28("01031005545400"),I28("0141057f145000"),I28("003044ffffc000"),
I28("00555455555440"),I28("000004ffc00100"),I28("00100f15555500"),I28("0040d1554c3040"),
I28("003cc3ffd04000"),I28("03c015557ff000"),I28("0101cc53fffc00"),I28("0100047f030300"),
I28("0055514f155400"),I28("0000ffffffcf00"),I28("00540555430f00"),I28("00104f04441400"),
I28("01543c3fdcc000"),I28("0154f035550f00"),I28("00440fc5540000"),I28("001554fc010400"),
I28("03fffcf550fc00"),I28("004f0530fc3c40"),I28("03fc0555110400"),I28("00111155555400"),
I28("03c117f1540500"),I28("30030cfd555500"),I28("03ff054c114500"),I28("015513f4175400"),
I28("00ffcfc5cffc00"),I28("00007f15530000"),I28("0ff15555453f00"),I28("0103f3f5500c00"),
I28("000ff0354fff00"),I28("015330c5555000"),I28("01515457f05540"),I28("00555433f10000"),
I28("005015fccff000"),I28("00f03d57ff00c0"),I28("014d57f4045000"),I28("0fffc3c555ff00"),
I28("03f055314c0000"),I28("00ffffd5400000"),I28("33fff0555ffc00"),I28("000554ff030540"),
I28("000f03fcfcf000"),I28("00f30f55fffc00"),I28("00554ff1510100"),I28("001555ff305400"),
I28("00fffffc043040"),I28("001540fc555000"),I28("00001557cf3c00"),I28("00c0c155405000"),
I28("00144557ff3f00"),I28("00c00cff0fc000"),I28("01401400400050"),I28("0057ffc4ff0400"),
I28("00ffc1ffffc000"),I28("03ffffcff03f00"),I28("0154fff5415400"),I28("0ffc055540ff00"),
I28("0143c1fd5400c0"),I28("03cf0071454000"),I28("03d5557cc0c000"),I28("00fc0d7fffff00"),
I28("00f15555400000"),I28("00400175555500"),I28("0154414fd55400"),I28("014c0000ffc000"),
I28("00554055555400"),I28("00c0343ffc3000"),I28("00000315555500"),I28("000003ffffff00"),
I28("00303ffff44000"),I28("03cc44557ffc00"),I28("00000017fffc00"),I28("00001441501000"),
I28("30557ff3c45500"),I28("00403ffff0cf00"),I28("05555555554300"),I28("00003f3c051500"),
I28("00444cffc30000"),I28("005470315543c0"),I28("00503fc1453300"),I28("00034530400000"),
I28("00fff3fd510000"),I28("054300fffffc00"),I28("33fc155554f000"),I28("05555155055500"),
I28("030003ff554400"),I28("031700ff555500"),I28("0ff0057c000100"),I28("0154744fc05000"),
I28("03ffcc1544c000"),I28("03003015540300"),I28("03fc555400ff00"),I28("00003f35400c00"),
I28("015ff0c54fff00"),I28("0c0130fd555400"),I28("0c40041ffc0040"),I28("0c15540fc44100"),
I28("015404fc30c000"),I28("00c00c553c0000"),I28("03c017f5034400"),I28("3ffc0401553f00"),
I28("0305553c510000"),I28("003ffff1504300"),I28("03fff0514ffc00"),I28("004555ff3c0500"),
I28("0104c3ff0fcc00"),I28("00fcc7557fff00"),I28("00155ffc400000"),I28("0015543c0c1000"),
I28("00ffffffffc000"),I28("005545fc540000"),I28("03315555500f00"),I28("000335551503c0"),
I28("00054555fffc00"),I28("00c403ffcfc000"),I28("0054403ccc0500"),I28("0057ffd5f0c000"),
I28("00005503ffff00"),I28("00ffff53f0ff00"),I28("01550135545400"),I28("000fd55573ff00"),
I28("0c540031555000"),I28("03fcf435555000"),I28("03f5554f30c000"),I28("03033c00fffc00"),
I28("00004115440000"),I28("00c0047c555000"),I28("005500cfc45540"),I28("004c003000f000"),
I28("30155045555500"),I28("0333f03ffff000"),I28("000fc010d55400"),I28("00000f0ffff300"),
I28("000f3f3ffc0000"),I28("0fc40341ffc000"),I28("040c3014ffff00"),I28("0000c105540000"),
I28("01143fcff55500"),I28("00113fffcc0300"),I28("01555555555400"),I28("0030f3f30c0000"),
I28("0010100f141000"),I28("0005000d555400"),I28("0003cc004003c0"),I28("003c0c33400000"),
I28("000130fc540000"),I28("055501fffff300"),I28("03fcc55543fc00"),I28("05555455411000"),
I28("010303fffc0000"),I28("000410ff155500"),I28("03c1555fcccc00"),I28("01551357504000"),
I28("000cc005115000"),I28("00cffc05554c00"),I28("00ffc5157ffc00"),I28("001033f1430c00"),
I28("015030055503c0"),I28("0c030c00154500"),I28("00103f0ffffc00"),I28("03011403c00000"),
I28("015504fc404000"),I28("00c00355730000"),I28("00f017f53fc400"),I28("0ff1703c55ff00"),
I28("0015553d541400"),I28("0043fffc550000"),I28("03fcfc1053f300"),I28("0155557ff05000"),
I28("01400fff3cc000"),I28("00f00f554fff00"),I28("001550cc105000"),I28("00cc150c5c1000"),
I28("000cfffffcf040"),I28("0055557c500400"),I28("00cd5555554300"),I28("0003015550f300"),
I28("00041515403000"),I28("03c03fc0000000"),I28("0145100f00c000"),I28("0157fff50fc000"),
I28("00055440033c00"),I28("00ff0010ffc000"),I28("05557071555400"),I28("0000c1153ffc00"),
I28("30504401505400"),I28("00fcc5f1545000"),I28("03fd554c0c0000"),I28("103c0c05533c00"),
I28("01011153fcf000"),I28("00ff54ffc04100"),I28("000000ffc51100"),I28("004c003c0c0300"),
I28("3c055000455500"),I28("00ccc0f3cffc00"),I28("0000f000015400"),I28("30440ff3ff0c00"),
I28("003fff3ff00000"),I28("0fd54353cfc000"),I28("040030143ccf00"),I28("000fcc05404000"),
I28("3c503fcff55000"),I28("010f0fff1033c0"),I28("0555554d555400"),I28("00f0fffcd33000"),
I28("00400fcc314500"),I28("001440fd544000"),I28("01033f17f3fc00"),I28("01ff313c540c00"),
I28("0555403cc55000"),I28("015554ffffff00"),I28("030cc54d3ffc00"),I28("01404055410000"),
I28("00003fffffcc00"),I28("000000ffc55400"),I28("3fc40057ffcc00"),I28("01511fc4d47400"),
I28("0000ffc1554000"),I28("000f3010555000"),I28("003ff11543fc00"),I28("0000ffc1543f00"),
I28("01555001550300"),I28("0c4c0c13001500"),I28("00c43ff3fff300"),I28("0015150fd00000"),
I28("015555fc345400"),I28("00040015500000"),I28("00fc553fffc400"),I28("3ff1113c15ff00"),
I28("0415557f010400"),I28("004f13ff144400"),I28("00f0cc170fc000"),I28("0105555ff14c40"),
I28("001133ff015500"),I28("0000305503fc00"),I28("0301543d005400"),I28("0030110c400400"),
I28("004513fff30000"),I28("0054054d500000"),I28("003c155554ff00"),I28("0500015500ff00"),
I28("0004015550f000"),I28("03050ffc0ff000"),I28("054550cc4f3300"),I28("0507ffc5000400"),
I28("00315053cf3c00"),I28("03ffd00c000000"),I28("0555047c5557c0"),I28("00400cd4fffc00"),
I28("0040c111504000"),I28("00f3053c154000"),I28("03fc5553c10000"),I28("01030c01555000"),
I28("0155057ffffc00"),I28("0f04050cc00000"),I28("000403ffcc4000"),I28("004c003c030000"),
I28("0f01530f0c3500"),I28("00ff3cfcc0fc00"),I28("00000c00334000"),I28("0f000ff3fffc00"),
I28("00033fcff0fc00"),I28("0fc15303fcf000"),I28("04040c5403c000"),I28("00fff305540000"),
I28("0c010ffff54000"),I28("03c3fff05400c0"),I28("0555540f555500"),I28("00fff0ff40c000"),
I28("004004ffcc1400"),I28("0001407c155000"),I28("0130ff101fff00"),I28("0003c0fd40c000"),
I28("0555550ff15000"),I28("011540ffc33f00"),I28("000ffd4c3ff000"),I28("0000c1554c3c00"),
I28("00410ffffff000"),I28("0f3d013ffc0430"),I28("0f0c0017fffc00"),I28("00143f0f151300"),
I28("005400d543ff00"),I28("00c3f301155400"),I28("003ffc3554ff00"),I28("00041031150c00"),
I28("01555500545400"),I28("0c30f340030400"),I28("00ff3ff300c300"),I28("00c0315fccc000"),
I28("0055557f055400"),I28("000011c554f000"),I28("00f0053fffc400"),I28("3ffd540f54ff00"),
I28("0005557f411500"),I28("01540fff041000"),I28("0ffcff543f0000"),I28("04c45557c54c00"),
I28("015557ff555500"),I28("00000355403c00"),I28("0f0055043d1100"),I28("03cc04401c0100"),
I28("0004477cffc000"),I28("01540141540000"),I28("03fff1057ffc00"),I28("01504155500f00"),
I28("00c01545445000"),I28("00005ffffffc00"),I28("001543cc333000"),I28("0554fff43c1400"),
I28("0104055000c000"),I28("00ffc133430000"),I28("0144110d555fc0"),I28("0000503ffff000"),
I28("003cc154440700"),I28("00c00540015000"),I28("000f0554050100"),I28("0030c011045500"),
I28("011550fffffc40"),I28("3f0c003c400300"),I28("000503f3004400"),I28("00453333003c00"),
I28("0f0054cf3cfd00"),I28("003f033f003000"),I28("000100c414c000"),I28("0f003ff0ff0400"),
I28("00000fffcc3c00"),I28("0fc4030ffffc00"),I28("040d0c50544500"),I28("00ff0335500000"),
I28("00000fc7c507c0"),I28("0003ff155404c0"),I28("01554fcfd55540"),I28("00cfcc3f1010c0"),
I28("0c00103fc30040"),I28("00004003f15000"),I28("00033ccfd03000"),I28("0433003d54c000"),
I28("0155554ffc50c0"),I28("014153ff000000"),I28("0d30fc5fffc000"),I28("0000c055440f00"),
I28("000c07fffffd00"),I28("0fc1051fffc3c0"),I28("0ff00315ffc000"),I28("00133f0f155300"),
I28("00100f3fffff00"),I28("0015050cc55400"),I28("003ffff155fc00"),I28("030110c1550000"),
I28("0555543c540500"),I28("0c0f0000001000"),I28("0ccc3ffd4f3000"),I28("03000157f00c00"),
I28("0315554f315500"),I28("0000000554c300"),I28("0330c53fffd400"),I28("0fff174f1ff000"),
I28("01355543045400"),I28("001500ffc00000"),I28("0f300f10431700"),I28("05051555c03300"),
I28("00515501555400"),I28("00430f550f0040"),I28("0c3c0570115400"),I28("0cfcf040531500"),
I28("03000403f3c000"),I28("0055734555c000"),I28("03fff04fffff00"),I28("01440d553303c0"),
I28("000105154040c0"),I28("000053ffffff00"),I28("00100fc04c0c00"),I28("055573f1005400"),
I28("011010033c0000"),I28("003fc104000000"),I28("00545435554fc0"),I28("0004553fff0500"),
I28("0fc30014004000"),I28("00000040014000"),I28("033ff115053100"),I28("0000cc40401500"),
I28("004403fffff140"),I28("00cc3c0d043fc0"),I28("0c104ffc0c0000"),I28("0015103f03c000"),
I28("0fc0153f3f3000"),I28("00030fcf0004c0"),I28("00010007010fc0"),I28("03ffcff33ff000"),
I28("004033fffff000"),I28("03f3044ffccc00"),I28("05450551555400"),I28("000000f1500000"),
I28("00f00ff4343f00"),I28("0103ff55555700"),I28("00403fff315500"),I28("0013c03f0113c0"),
I28("03c00ff300c100"),I28("00534013fd5500"),I28("015455c0104400"),I28("014c0031550100"),
I28("0100315fff54c0"),I28("001544cc000100"),I28("0c00cf53ff1140"),I28("0000fc15500000"),
I28("001031ffcc0000"),I28("03c40417fc0fc0"),I28("0f3000153fc000"),I28("0043fc5fd54c00"),
I28("001154ffffff00"),I28("00555553c15400"),I28("00c3f0fd55ff00"),I28("03cd0131514000"),
I28("015544fc150100"),I28("0f003c01010300"),I28("00fc0ff143ff00"),I28("0300c057fff000"),
I28("0305554fff4400"),I28("000c3c00543000"),I28("0303317ffc5400"),I28("0ffc015ff30000"),
I28("01335553151500"),I28("0310003fd11300"),I28("00ff1310440000"),I28("050411553f0700"),
I28("05555555555400"),I28("005330d5704000"),I28("00ccc051045500"),I28("0cf3cf00400140"),
I28("03031010050300"),I28("03557ff0470f00"),I28("0c33f33ffffc00"),I28("00403f13fc0fc0"),
I28("000fc115555400"),I28("0033d1fffffc00"),I28("00430001504000"),I28("01555330155500"),
I28("01004410cc0000"),I28("00ffd505003f00"),I28("03ffc4fd543fc0"),I28("0001047fff1540"),
I28("03f001050f3f00"),I28("0001301ff01400"),I28("00ffff14153000"),I28("01000000c11400"),
I28("001430ffff1140"),I28("03fd0cffcfffc0"),I28("00f053fc500000"),I28("0115553c100000"),
I28("0000154fff3c00"),I28("0000333fcc1400"),I28("00000c015ccf00"),I28("0cffffcdc00300"),
I28("000d30fff03000"),I28("03c3010ff0c500"),I28("01410155554100"),I28("00010331554040"),
I28("00c00ff1530cc0"),I28("053cff55500f00"),I28("0000ffffcc1400"),I28("000fc3f3c150c0"),
I28("03f033c500f040"),I28("00001404fd5500"),I28("00555555555540"),I28("014033c1554500"),
I28("000f004ffc54c0"),I28("00c50355501540"),I28("0c337017fc0400"),I28("00fcccfc013c00"),
I28("0030cc01554400"),I28("03f55055ffc000"),I28("03f030557fcc40"),I28("00033f0fd54400"),
I28("001111ffffff00"),I28("0015554f015400"),I28("0003fcfc54ff00"),I28("03f30f71550000"),
I28("0055140c555500"),I28("003c0441110300"),I28("00544555500f00"),I28("00ff0415fffc00"),
I28("03c0440fffc100"),I28("0000004154c000"),I28("00cc14c3fd5400"),I28("0c3f00173f1400"),
I28("003ff115443400"),I28("00051030440000"),I28("00ff0c004300c0"),I28("000075553f3000"),
I28("01555555555500"),I28("000003c5404000"),I28("00c33410000400"),I28("003ffc01401100"),
I28("03fff000014c00"),I28("0c5543fc0cc3c0"),I28("00fc3f3ffffc40"),I28("00000fffc0ccc0"),
I28("003c33f5544000"),I28("0001054ffff000"),I28("03c30501500c00"),I28("01155535555400"),
I28("01404300c00000"),I28("00ffc100c30fc0"),I28("030c0cfcffff00"),I28("0030013ff01540"),
I28("00c00015533f00"),I28("01000f3ffcc000"),I28("0003ffff10c000"),I28("04033000040100"),
I28("00c0cc04015540"),I28("03f03fffffff00"),I28("000005fc410000"),I28("00155541554000"),
I28("0300054fcfcc00"),I28("00154c40005400"),I28("00c00c00000fc0"),I28("00c3ffc0101000"),
I28("0050014033f000"),I28("00f33403c000c0"),I28("01400110155400"),I28("00000cfc550400"),
I28("030c0ff540cfc0"),I28("00003d51500000"),I28("0000c0cf3c0000"),I28("0000c303cd54c0"),
I28("0000cff54c0000"),I28("00000044fd5400"),I28("00541555555540"),I28("004033f5510500"),
I28("000ff03ff104c0"),I28("00c00015555500"),I28("0f00ff57ff4140"),I28("003c0fffff0000"),
I28("00cf33d5551500"),I28("001401553fcfc0"),I28("00f005557ff000"),I28("00f3ff4fd507c0"),
I28("0001444ffffc00"),I28("0011554fcc5500"),I28("00133ff400ff00"),I28("00fffcf15413c0"),
I28("00550c40155400"),I28("00001445510000"),I28("00555555500000"),I28("00ff0455ffff00"),
I28("00ff000cff0140"),I28("00401400550000"),I28("000300f3cc1000"),I28("003cfd17fc0000"),
I28("00ffffc043fc00"),I28("000110c054c700"),I28("033c00005403c0"),I28("00434c53fc3000"),
I28("01455555554100"),I28("004400f5510300"),I28("03031054000500"),I28("0003c011400140"),
I28("000cff00043f00"),I28("00155c303f3300"),I28("03fc0300ffc540"),I28("0cf0c330c03f00"),
I28("0033fcfc040400"),I28("00454554011000"),I28("00ff105550f000"),I28("00155555555500"),
I28("004700000c0000"),I28("000ff000003f00"),I28("03ff30703fff00"),I28("00f000f3014100"),
I28("00c00115533f00"),I28("0100f3ffffff00"),I28("030fc033c04140"),I28("00c0c00c000000"),
I28("00103001555440"),I28("00fc30ffff3fc0"),I28("000c057ff00000"),I28("00010015150000"),
I28("00f0c153ff4300"),I28("00555505555000"),I28("000300c0043c00"),I28("00001543145000"),
I28("0051005550f300"),I28("00f030030d0c00"),I28("01545015554d00"),I28("0014003c555100"),
I28("00cccff15373c0"),I28("000ffd40404f00"),I28("000cffcf30fc00"),I28("00033f3f001000"),
I28("0030f3d400c000"),I28("00040004015400"),I28("00171455555500"),I28("00443fc1440000"),
I28("0004003f150000"),I28("033c0055545500"),I28("03c0cc57ff0000"),I28("0000f00ffff300"),
I28("03c3f054544400"),I28("0000054543ff00"),I28("000f05553fcc00"),I28("00ffff0f140000"),
I28("00010054000140"),I28("0011540cc04400"),I28("0000030503c300"),I28("003cc3c5545000"),
I28("004c0004055400"),I28("00055540045000"),I28("00101115550000"),I28("00ff0155fff000"),
I28("003fc001330500"),I28("00000054001000"),I28("01405f30340000"),I28("000f1010fc0300"),
I28("00fffff0fffc00"),I28("000011fd03c000"),I28("003f00c004fc00"),I28("000ff03f3cc000"),
I28("0045555003fc00"),I28("000000f1500f00"),I28("00000511000100"),I28("00003015110500"),
I28("003f0ffcf3fc00"),I28("001557f0cf0c00"),I28("003f0cf3d11500"),I28("03ffc3f11c00c0"),
I28("000c3fcfcc0000"),I28("00401555555000"),I28("00ff155553ff00"),I28("00055455415500"),
I28("00500100100000"),I28("000fff00300f00"),I28("03fff0103fff00"),I28("00fc40f0050400"),
I28("0003045550ff00"),I28("00003fcffffc00"),I28("000f0000000000"),I28("000000c0010000"),
I28("0003c004154400"),I28("0000d04dffffc0"),I28("0000017fc00000"),I28("00014114514000"),
I28("003fc5450c3000"),I28("00555515554000"),I28("00030004003c00"),I28("03005554555000"),
I28("00515511400000"),I28("003f3010000700"),I28("000d474c530100"),I28("0004000cd55400"),
I28("00304ff1441000"),I28("0000fc45405300"),I28("0000fc3f0cc000"),I28("00ccc3fc100000"),
I28("00333c15510000"),I28("0034010d141000"),I28("00154115555000"),I28("00003cc5504000"),
I28("040154310000c0"),I28("00fcf051100000"),I28("00f3c1540c0000"),I28("003000c00f3300"),
I28("00ff0544040000"),I28("0050501003f300"),I28("00541154303000"),I28("000f0f0d540300"),
I28("00001011555500"),I28("00415430433100"),I28("0004c0540fc000"),I28("003f3c05510000"),
I28("0033c044155400"),I28("00055554515300"),I28("00401100155400"),I28("003c3400fff000"),
I28("00fc3c3030fc00"),I28("00000110004000"),I28("00513304100c00"),I28("0030f000cfff00"),
I28("00cfffffff0c00"),I28("00000001103f00"),I28("00ccc000c03000"),I28("00000fffc0f100"),
I28("015001c030c000"),I28("0000003d445000"),I28("00030c05103c00"),I28("00003450011400"),
I28("0033cc0c33c000"),I28("0005553ccc3000"),I28("003ff030155500"),I28("033cf3cc033000"),
I28("00003c30fc0000"),I28("00415155555400"),I28("03ffff00c3c000"),I28("00015554700000"),
I28("00010000000c00"),I28("0003fc00300000"),I28("00fcfc1533ff00"),I28("00fc3000430000"),
I28("030550450ff000"),I28("000ffffc3ffc00"),I28("00004301004000"),I28("00000cf0fc0400"),
I28("03000c00030000"),I28("00105555500000"),I28("0003104fff0000"),I28("0000f005451400"),
I28("000c1541040c00"),I28("00505555410000"),I28("00003015503000"),I28("00305555554000"),
I28("00400404540000"),I28("00ffc040155000"),I28("00003ffffcc000"),I28("00151c03c55000"),
I28("00000ff14f1000"),I28("0003f155400300"),I28("0033ff003c0000"),I28("00000f331c0000"),
I28("000ffcd5000000"),I28("00330cff055000"),I28("0001014143f300"),I28("0000f305010000"),
I28("0030c50040c000"),I28("00ff0043c00000"),I28("003f0155ccf000"),I28("00000040f03300"),
I28("000015000f0000"),I28("0055504f10fc00"),I28("00155553cc0000"),I28("000ff3c5540f00"),
I28("00003c45555500"),I28("000540cf01c000"),I28("00f305c40fc000"),I28("000f0115443000"),
I28("00fff345555000"),I28("00055555533000"),I28("00040000155000"),I28("000003fcffc000"),
I28("0003c30fd04000"),I28("0014110d440000"),I28("00144015553c00"),I28("00fcf7f003fc00"),
I28("0033fffffc0300"),I28("000f0010000000"),I28("000f00011003c0"),I28("0040cfff000f00"),
I28("00540fff014000"),I28("0000033f551000"),I28("00051100430c00"),I28("000000100c0000"),
I28("000c3040400400"),I28("00015543f30000"),I28("000f33fc001500"),I28("003ffcc3000300"),
I28("004400fc330000"),I28("00155411555000"),I28("0003ffffffc000"),I28("00055155140000"),
I28("000000fc003cc0"),I28("0000fc04c44000"),I28("00fff05503c000"),I28("003f0005000000"),
I28("0301514ffff000"),I28("00003cf30cfc00"),I28("00000104c10000"),I28("0003cc03c30000"),
I28("0000000103f040"),I28("00155555555400"),I28("00030153fcc000"),I28("00030000004000"),
I28("00005541550000"),I28("00001140310000"),I28("00011003000000"),I28("000fc55553c000"),
I28("00100400404000"),I28("003ff005555400"),I28("00033ffffcc000"),I28("00000f3fc55400"),
I28("00000ff1555400"),I28("0033f3503cff00"),I28("00033ffff01000"),I28("000300540c0000"),
I28("0000fcc5105400"),I28("000cd104555000"),I28("00001411ffff00"),I28("0010004043c000"),
I28("0000000cc0c000"),I28("000ff141141400"),I28("00004144040000"),I28("0001403f300f00"),
I28("00000003ffc000"),I28("00015400000f00"),I28("00555550cc1400"),I28("000ff0c5400c00"),
I28("00000455555400"),I28("0050000d540c00"),I28("000fc5500cc0c0"),I28("0000fd54030000"),
I28("003ffc05540000"),I28("0000455403c000"),I28("00040454541000"),I28("00015040010000"),
I28("0000f034014000"),I28("00410000000000"),I28("00005555433000"),I28("003f043300ff00"),
I28("000133ffc00000"),I28("00001000000000"),I28("0003c300c03300"),I28("00003c33c00000"),
I28("0000fffc303000"),I28("0033fcc0154000"),I28("00004045004000"),I28("00000045000000"),
I28("0000f003004000"),I28("00000555505000"),I28("0000ff03145100"),I28("0033ff00143000"),
I28("000000003f0000"),I28("00000014445400"),I28("003000fff00000"),I28("0001455444fc00"),
I28("00013000f0c000"),I28("000ffc11555400"),I28("00000c15555400"),I28("000fcc14015400"),
I28("00003d0fffc000"),I28("00040cff00cc00"),I28("00001133001400"),I28("0003ff00451000"),
I28("00000003000000"),I28("00115555555400"),I28("0055011303c000"),I28("00000515541000"),
I28("00015500000000"),I28("00115555554000"),I28("00055003000000"),I28("000ff33ffff000"),
I28("00005451450000"),I28("00000155550000"),I28("000003fffc0000"),I28("000033ff000400"),
I28("000003f1555400"),I28("0000300ffc0000"),I28("000c00cfc00000"),I28("00005555450000"),
I28("0000fff5555000"),I28("0000cf00554000"),I28("0003000ffffc00"),I28("000105401c0000"),
I28("000ffc3030c000"),I28("000fc045555400"),I28("00000450144000"),I28("0000000ff3c000"),
I28("0000110f3f0000"),I28("00000030300000"),I28("00014440440400"),I28("000fff15400000"),
I28("00000015555400"),I28("00040c01001000"),I28("000fd553f00000"),I28("00010cf00ffc00"),
I28("000f3fffccfc00"),I28("000fff3fff0000"),I28("00055555540000"),I28("00015540004000"),
I28("00004001054000"),I28("00010001500000"),I28("000055440c0000"),I28("000f1004100c00"),
I28("00050000005400"),I28("00030001000000"),I28("00003ffc003000"),I28("00000001410000"),
I28("00003ffffff000"),I28("00033f00155000"),I28("00000000540000"),I28("00000400030000"),
I28("00000001010000"),I28("00000155554000"),I28("00000000101400"),I28("00000055554000"),
I28("0000c000000000"),I28("0000c015000000"),I28("00000555000000"),I28("000001010f0c00"),
I28("00001011000000"),I28("000ff155554400"),I28("00000c55555500"),I28("0003ffc1155400"),
I28("000cfffffc0000"),I28("00004300300000"),I28("00000000d00000"),I28("000cc040444400"),
I28("00003000000000"),I28("00000055550000"),I28("0015554fffc000"),I28("00015545000000"),
I28("00000100c00000"),I28("00005555540000"),I28("00014000000000"),I28("0000303cfc0000"),
I28("00000050040000"),I28("00005510000000"),I28("0000000c000000"),I28("0000ffc10fc000"),
I28("00000001400000"),I28("00000000400000"),I28("00000300c00000"),I28("00005555410000"),
I28("0000ffc5540000"),I28("000003fc040000"),I28("00000030000000"),I28("00004050000000"),
I28("0003fc30000000"),I28("00000014111000"),I28("00000400000000"),I28("000003c0000000"),
I28("00001400010000"),I28("00000400000000"),I28("00010004000000"),I28("0000f000040000"),
I28("00000000000000"),I28("00003c01000000"),I28("00000000000000"),I28("000000300c0000"),
I28("000003ffc30c00"),I28("000cfff30c0000"),I28("00005555444000"),I28("00010451040000"),
I28("00000444000000"),I28("00050004040000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("000003f0000000"),I28("00000000000000"),I28("00000040000000"),
I28("00000000000000"),I28("0000c333000000"),I28("00003000500000"),I28("00000010400000"),
I28("0000333fffcc00"),I28("00000015400000"),I28("00000000000000"),I28("00000000400000"),
I28("0000c000000000"),I28("000000c00c0000"),I28("00030045410000"),I28("00000000003000"),
I28("00000000000000"),I28("0000c155440000"),I28("00000000000000"),I28("00000000000000"),
I28("0000cffcf00000"),I28("00000014000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("0005550fc00000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000400000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("0000000c000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000003000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
	};
#pragma HLS array_partition variable=w1 cyclic factor=FL
	int16_t gamma1 = 1081;
	int16_t beta1 = -44;

	static int16_t acc[FL];
#pragma HLS array_partition variable=acc

	for (int j = 0; j < FL; j++) {
#pragma HLS unroll
		acc[j] = 0;
	}

	for (int i = 0; i < H; i++) {
#pragma HLS pipeline
		int2x28_t vi = ins.read();
		for (int j = 0; j < FL; j++) {
			int2x28_t wi = w1[i * FL + j];
			acc[j] += bit::multiply_add<W>(vi, wi);
		}
	}

	int2x64_t oval;
	for (int j = 0; j < FL; j++) {
		int16_t sum = gamma1 * acc[j] + beta1;
		int2_t v = (sum > 0) ? 1 : -1;
		bit::set<FL>(oval, j, v);
	}
	outs.write(oval);
}

void affine2(fifo<int2x64_t>& ins, fifo<int2x64_t>& outs) {
	static int2x64_t w2[FL] = {
I64("5C77C517C5413545DCF515C4414F11D7"),
I64("F0DC737C5FF7FFC453D70C5FD1DFF745"),
I64("3C5FF017C1F77FFD3FFDCDC4F1F3D57F"),
I64("FFF1317F7F505F37354CC74117F35CCF"),
I64("314C75537D07C3D3033DDD10C334F444"),
I64("715F304D34F73FC73CCC3FD3DDF7D730"),
I64("CF35CD07045D0573F14007F557075DCF"),
I64("451457CD5C5FF511C1F411DC33513755"),
I64("43DD175C7F07DFF757537343D3C1175D"),
I64("F1447D04F5D471DCFD3DDDDDF7F3C53F"),
I64("1701D5DC555D5D7D53DF170437CD37CC"),
I64("7D7375750DF7CFD4CFF11F5F7D730F17"),
I64("05C150754CD3C3DFF575DC1DC7FF7331"),
I64("F757CCFD37FF5CFF4FDF3F403C33CF37"),
I64("0DFC75575D13D7705531D01014CD143C"),
I64("F0177FFDD7F15D45FFD7077D745F4FCD"),
I64("4547755135073CD4CFF5CCDC437F0C54"),
I64("734DD51D75557FF74C1F7CD45F3FDD10"),
I64("F454453505534DD3FF04CC1C7F7F4F34"),
I64("C1C155DC5D13D3005F04DF5C371CD451"),
I64("5D4301D5D5C57DC55FC11DD7717FC3C3"),
I64("33D10FFD37355C774713737F5FC31FD3"),
I64("C174F5F7044C5177730FD77137301DF3"),
I64("34540CC7D4F571DDFDF13DF5F1C4F03F"),
I64("17C3357F7D4F17175F03445C4D453157"),
I64("FFDDFF3C73D45FFF345F3F01D3F31FFC"),
I64("FF14FF37D7413413F55D34FD04047DFF"),
I64("371CF04C75F74FCF534F3F141C34DC77"),
I64("F5F55C1C7153100FC540C35D17FF5C1D"),
I64("7D7DF45413F57F354DFDDFF7C5C0D7FF"),
I64("17C1D7CC503C5D7C53DFD77531D1D4FC"),
I64("D7D3D3FC033F4D0F475F77730D15F745"),
I64("DF3CF1570C4D1777007DF4355C055DCF"),
I64("735C0C11F5C43CDCCD077DD41D37F071"),
I64("77DDDF4DF7114CCCC55370371C374FD1"),
I64("DF03F4131D0F170C033F71C53D55054F"),
I64("1714DFF0D44C415D400F4530FD15F304"),
I64("40D34F41C7F5FC15CCD47C335D5F3FD5"),
I64("3F1F3F77DFF5F301C3C175F7DD15C070"),
I64("51FC55510F5CC715D0155443505F4715"),
I64("5751DCC0F4017D3C300F35F53D350CCF"),
I64("3C5D7F7F07F47FFF7503CF03D7FFD3FD"),
I64("53F5DC31375DC107F557770C53474CD4"),
I64("F5557F74C314F7D0F5753CDD17377C31"),
I64("D7DD133D530F1F775757577FD3DD13DD"),
I64("5FF0D4DCD74DD5455C1774775D514CD5"),
I64("FD3570775FC1047FF53DD7CCF7CF1DFF"),
I64("475C3C35C7343CD5DFC77CCF5D577F15"),
I64("754C01573157F3DCCD3D4DD410773544"),
I64("7FCCFF50FFF5FFFC15147F37DD031031"),
I64("7F7DC15C3555C4D7C553740450775DD0"),
I64("7D7D41553155F7D4FD357DD7573F5C11"),
I64("FF43F513F1F74CF07F0FFDF13D77DC7F"),
I64("C755DCC7D45C711D354F35F5F1C5F573"),
I64("C5C440354F13CF14F105135C371F7F15"),
I64("47DD13D01005350D457DDDD4F4D5F77D"),
I64("513F45D5575C11445F154740531D51D5"),
I64("5FFD145C7C50D7770540705753545155"),
I64("44D15F3DD3C53D1501D74F4FC3DF77D1"),
I64("CDF375471C33C714F031D11CC4CCD57C"),
I64("FF75DFD014D1413C354FF305C7DF5FFC"),
I64("10C1145C7D5C100FD547701457714151"),
I64("D5C77FF7DD0C355DC0F5D5DD345D35F1"),
I64("1FF1D5137D5DD57C54010504544D4151"),
	};
#pragma HLS array_partition variable=w2
	int16_t gamma2 = 98;
	int16_t beta2 = -1;

	int2x64_t vi = ins.read();
	int2x64_t oval;
	for (int j = 0; j < FL; j++) {
#pragma HLS pipeline
		int2x64_t wi = w2[j];
		int16_t acc = bit::multiply_add<FL>(vi, wi);

		int16_t sum = gamma2 * acc + beta2;
		int2_t v = (sum > 0) ? 1 : -1;
		bit::set<FL>(oval, j, v);
	}
	outs.write(oval);
}

void affine3(fifo<int2x64_t>& ins, fifo<int16_t>& outs) {
	static int2x64_t w3[CL] = {
I64("54F77755770D55557FDD7FFF3FFC5FF0"),
I64("0F73F1F7DDF7DF7D5755D77FD37DF557"),
I64("FDCFF1545F51D7D5F75755D57777D75D"),
I64("DC5F0F74037757F7C7FF7D7CDD0774D5"),
I64("D11F57FFDD44CDD35DD7570F45D45F73"),
I64("5475DD1CDF5F3F7DFDCDDF5D1D775D7D"),
I64("75D57354D5C573DDD5F7C577DFDDCF7D"),
I64("74FF75FDFFFDFD77557D5D55F7D775DD"),
I64("F4D7C3557D5770177D75F755F50D7537"),
I64("DF5DDFF375DF75CC5FFD11DD435C7FF1"),
	};
#pragma HLS array_partition variable=w3

	int2x64_t vi = ins.read();
	for (int i = 0; i < CL; i++) {
#pragma HLS pipeline
		int2x64_t wi = w3[i];
		int16_t acc = bit::multiply_add<FL>(vi, wi);
		outs.write(acc);
	}
}

void read_input(const int in[H * W], fifo<int2x28_t>& ins) {
	for (int i = 0; i < H; i++) {
#pragma HLS pipeline
		int2x28_t oval;
		for (int j = 0; j < W; j++) {
#pragma HLS unroll
			bit::set<W>(oval, j, in[i * W + j]);
		}
		ins.write(oval);
	}
}

void write_result(int out[1], fifo<int16_t>& outs) {
	int16_t max = outs.read();
	int m = 0;
	for (int i = 1; i < CL; i++) {
#pragma HLS pipeline
		int16_t v = outs.read();
		if (v > max) {
			max = v;
			m = i;
		}
	}
	out[0] = m;
}

void kernel(int in[H * W], int out[1]) {
#pragma HLS interface axis port=in
#pragma HLS interface axis port=out
#pragma HLS array_partition variable=in cyclic factor=W

	fifo<int2x28_t> ins("input_fifo");
	fifo<int2x64_t> pips1("pipe_fifo1");
	fifo<int2x64_t> pips2("pipe_fifo2");
	fifo<int16_t> outs("output_fifo");

#pragma HLS dataflow
	read_input(in, ins);
	affine1(ins, pips1);
	affine2(pips1, pips2);
	affine3(pips2, outs);
	write_result(out, outs);
}
