#include "kernel.hpp"
#include <ap_int.h>
#include <hls_math.h>

#define I28(hex) int2x28_t("0x" hex, 16)
#define I64(hex) int2x64_t("0x" hex, 16)

const int W = 28;
const int H = 28;

const int FL = 64;
const int CL = 10;

using int2_t = ap_int<2>;
using int2x28_t = ap_uint<2 * 28>;
using int2x64_t = ap_uint<2 * 64>;

void sign_extend(int2x28_t& val, int width, int msb) {
	for (int p = 0; p < 2 * 28; p += width) {
#pragma HLS unroll
		val[p + msb] = val[p + msb - 1];
	}
}

ap_int<6> quick_sum(int2x28_t val) {
	int2x28_t val1 = val >> 2 & 0x33333333333333;
	sign_extend(val1, 4, 2);
	int2x28_t val2 = val & 0x33333333333333;
	sign_extend(val2, 4, 2);
	val = val1 + val2;
	val = (val >> 4 & 0x0f0f0f0f0f0f0f) + (val & 0x0f0f0f0f0f0f0f);
	sign_extend(val, 8, 3);
	val = (val >> 8 & 0x1f001f001f001f) + (val & 0x1f001f001f001f);
	sign_extend(val, 16, 4);
	val = (val >> 16 & 0x00003f0000003f) + (val & 0x00003f0000003f);
	sign_extend(val, 32, 5);
	val = (val >> 32 & 0x0000000000007f) + (val & 0x0000000000007f);
	return val(5, 0);
}

// Brevitasで学習した2bit重みを利用
// https://github.com/Xilinx/brevitas/
//
// bnn_pynq/cfg/fc_2w2a.ini
// [MODEL]
// ARCH: FC
// DATASET: MNIST
// IN_CHANNELS: 1
// OUT_FEATURES = [64]
// NUM_CLASSES: 10
// [QUANT]
// WEIGHT_BIT_WIDTH: 2
// ACT_BIT_WIDTH: 2
// IN_BIT_WIDTH: 1
//
// bnn_pynq/models/FC.py
// QuantLinear(in_features=in_features,
//		out_features=out_features,
//		bias=False,
//		weight_bit_width=weight_bit_width,
//		weight_quant=CommonWeightQuant)
// BatchNorm1d(num_features=out_features)
// QuantIdentity(act_quant=CommonActQuant, bit_width=act_bit_width)
// QuantLinear(in_features=out_features,
//		out_features=num_classes,
//		bias=False,
//		weight_bit_width=weight_bit_width,
//		weight_quant=CommonWeightQuant)
//
// @FIXME BatchNorm -> QuantIdentity部分をどう計算するかわからない。
// 理屈はわからないが二値(1, -1)にするとクリアできた。
//
void kernel(int in[H * W], int out[1]) {
#pragma HLS interface axis port=in
#pragma HLS interface axis port=out
#pragma HLS array_partition variable=in cyclic factor=W

	static int2x28_t w1[H * FL] = {
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00001400000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00001000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000001000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000100000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00051000000000"),I28("00000010000000"),
I28("00000000000000"),I28("00000000100000"),I28("00155555100000"),I28("00001400500000"),
I28("00030150000000"),I28("00000044000000"),I28("00001550000000"),I28("000003c0c0c000"),
I28("00000fff000000"),I28("00000110000000"),I28("00000101000000"),I28("00031555500000"),
I28("00000000000000"),I28("000000cc000000"),I28("0003cc30000000"),I28("00000010100000"),
I28("00001050000000"),I28("00000555500000"),I28("00000000000000"),I28("000c3f333cc000"),
I28("00000000000000"),I28("0030f004100000"),I28("00000000000000"),I28("00000000000000"),
I28("00000fff000000"),I28("00000000000000"),I28("00000000000000"),I28("00004554000000"),
I28("00000004000000"),I28("00000015000000"),I28("00004015000000"),I28("00003000000000"),
I28("00000000000000"),I28("000f3c00000000"),I28("00000000500000"),I28("000540f0000000"),
I28("00000000000000"),I28("00000011000000"),I28("00000104000000"),I28("000000c0000000"),
I28("0000ff3f300000"),I28("00000000000000"),I28("00000000000000"),I28("00051001400000"),
I28("00000000000000"),I28("0000033ccc0000"),I28("00054030000000"),I28("00000145400000"),
I28("00000cffc00000"),I28("00000000000000"),I28("00000000000000"),I28("00000100000000"),
I28("00000303000000"),I28("00011000400000"),I28("00000cfffcc000"),I28("0000000c000000"),
I28("00000000000000"),I28("00000001000000"),I28("00005000100000"),I28("00000cff000000"),
I28("00000040400000"),I28("00015540500000"),I28("01155000110000"),I28("00001455550000"),
I28("00000300000000"),I28("00ffffc1500000"),I28("00555555540000"),I28("00055550500000"),
I28("000cf155040000"),I28("000001103c0000"),I28("00545554f00000"),I28("00000f3ff30000"),
I28("00003fc3c00000"),I28("00cf05550f0000"),I28("00000001400000"),I28("00ffc555004000"),
I28("00030005140000"),I28("000103cc000000"),I28("0003fff30c0000"),I28("00055540000000"),
I28("00010144000000"),I28("00001555500000"),I28("0003003ffc0000"),I28("003ffffff0c000"),
I28("00015555000000"),I28("000ff3c1500000"),I28("00015455410000"),I28("00100415540000"),
I28("0000ffc0550000"),I28("00030155000000"),I28("00000515400000"),I28("01155554000000"),
I28("00300155550000"),I28("00054104440000"),I28("01544040400000"),I28("00000300000000"),
I28("0033c101540000"),I28("03ffc000000000"),I28("00055540000000"),I28("000154ff0f0000"),
I28("00000555500000"),I28("0000c055404000"),I28("00011554000000"),I28("00140ffc050000"),
I28("003fff0fff0000"),I28("00005403300000"),I28("00004fc0540000"),I28("00151300540000"),
I28("0000c0c1400000"),I28("000403ffcf0000"),I28("0005500ffc0000"),I28("00011554000000"),
I28("00ffffffff0000"),I28("00030430000000"),I28("00011055550000"),I28("00000144000000"),
I28("0000cfff000000"),I28("00055155500000"),I28("0003fffff30000"),I28("00000003c00000"),
I28("003cf333fc0000"),I28("00110555540000"),I28("00001530000000"),I28("000c0030000000"),
I28("0300cfc4550000"),I28("03fc1501550000"),I28("01004c30040000"),I28("00005555554000"),
I28("0004050c000000"),I28("03ffc555544000"),I28("00555555550000"),I28("03005555400000"),
I28("003ff014510000"),I28("000ffc043c0000"),I28("00044473ffc000"),I28("00004ff0fff000"),
I28("00430304100000"),I28("03fcc1500fc000"),I28("0033c001100000"),I28("003ffc15150000"),
I28("000c0150500000"),I28("010041cd400000"),I28("0155fc0d000000"),I28("03000005000000"),
I28("00540000400000"),I28("00015550003000"),I28("00003cfcc03000"),I28("00ffffffffc000"),
I28("00c05455540000"),I28("0143ccc1540000"),I28("0000cf00400000"),I28("0c1000c0040000"),
I28("0030c055550000"),I28("00300055541000"),I28("00140001150000"),I28("0054141100c000"),
I28("00fc1055554000"),I28("00033400140000"),I28("0155040f000000"),I28("00010005400000"),
I28("000c1514140000"),I28("00fff014000000"),I28("005544ffff0000"),I28("004154fff00000"),
I28("000c0d55451000"),I28("003f0555550000"),I28("00004154300000"),I28("00010103c00000"),
I28("03fc0053ff0000"),I28("003fc140030000"),I28("00040ff0554000"),I28("00c033c0410000"),
I28("00143300000000"),I28("00540000000000"),I28("001103f3fc0000"),I28("00f04554000000"),
I28("0033ffffff0c00"),I28("0030f43ccc0000"),I28("00414551554000"),I28("00000c15540000"),
I28("0043fff1510000"),I28("01554405550400"),I28("00103cf0330000"),I28("000100cc0cc000"),
I28("0030c000ffc000"),I28("00041005544000"),I28("000f0103000000"),I28("00001151000000"),
I28("00000f3c154000"),I28("03ffc444554000"),I28("00000f04100000"),I28("00005551550000"),
I28("0400f005400000"),I28("00015555554000"),I28("00017555555000"),I28("03fffcf0155000"),
I28("000c0555500000"),I28("004ffc550fc400"),I28("000504303ffc00"),I28("000000303c3000"),
I28("00030400540000"),I28("03000550c3fc00"),I28("00fc00c0150000"),I28("00ffffd5415000"),
I28("03033111000000"),I28("00fc0530003000"),I28("00555555410000"),I28("0cc00041700000"),
I28("00013f57400000"),I28("0014104440c300"),I28("000cfff1300000"),I28("003ffffffcf000"),
I28("00f0055554c000"),I28("00500131500000"),I28("00fc0c3f0f0000"),I28("00c00000003000"),
I28("003c0555545000"),I28("0ff31005550000"),I28("000414c0510000"),I28("01511404140000"),
I28("00f33d55545000"),I28("0000000cd00000"),I28("0003c003f0f000"),I28("00fffff1515000"),
I28("0000ffc0000000"),I28("00fffc05300000"),I28("005504fff00000"),I28("014443ffff0000"),
I28("00f04155004400"),I28("00c1155550cc00"),I28("00000d70cc1000"),I28("00005510003000"),
I28("03c00550cfc000"),I28("003fc554ff0c00"),I28("01553ffd555000"),I28("03f30501000000"),
I28("01553001400000"),I28("00414000400000"),I28("015553ffc00400"),I28("03f010010fc000"),
I28("015430033fcc00"),I28("003c0001000000"),I28("05540411555400"),I28("0000ff550c3000"),
I28("0043fff1550000"),I28("01555555554000"),I28("001043000cc000"),I28("00141fc0100000"),
I28("0000c155400000"),I28("00001c50110000"),I28("0030f01100c000"),I28("00055555400000"),
I28("0300cfff005000"),I28("0ffc1570155000"),I28("050c3fc0000000"),I28("0140ffff354000"),
I28("00000d00000000"),I28("05155555503000"),I28("0c3c0c30555000"),I28("0ffffffff00000"),
I28("01044145555000"),I28("0003fc543cd000"),I28("0000054300f3c0"),I28("00303fff000000"),
I28("0040d551333300"),I28("03c0555fff3000"),I28("00c33cfc004000"),I28("00fccc14055400"),
I28("00f3fcc0555400"),I28("00040001400400"),I28("055553f5145400"),I28("0c30f0003ffc00"),
I28("0040fc54000000"),I28("00044155000000"),I28("01555541141100"),I28("000fffcfc00000"),
I28("0303f315553000"),I28("00550301573000"),I28("00014555540c00"),I28("3ff00111c30000"),
I28("00033345415000"),I28("03f0c015545400"),I28("01500351001000"),I28("01551540400000"),
I28("03f31555441000"),I28("010300c0403000"),I28("03fc51557f3000"),I28("00c30155515000"),
I28("00015555500000"),I28("00ffcc00c00300"),I28("001043fff30000"),I28("004010ff0ff000"),
I28("00f13015001000"),I28("00000c3ffc0000"),I28("00cc000443f000"),I28("03d000430c0000"),
I28("03d5157003c000"),I28("153ff554000000"),I28("00403ff0555000"),I28("33fc55ff0c0000"),
I28("0155ff05003cc0"),I28("00145100c00000"),I28("0150014fc0d400"),I28("0ff3155473fc00"),
I28("0055540c0fff00"),I28("033000030c0000"),I28("01555111515500"),I28("0103fc55fc0000"),
I28("013fff55145000"),I28("000c4115551000"),I28("3340300c0c0000"),I28("00547ff543cc00"),
I28("00415011550000"),I28("00100000040000"),I28("0050fff0007c00"),I28("05405114400000"),
I28("030c3ffffff000"),I28("0ff31554c55000"),I28("05303fd0410000"),I28("000ffffffc0100"),
I28("00041540000500"),I28("05554555410000"),I28("00f3c015155400"),I28("0fffffffff4100"),
I28("05500001554000"),I28("0003ff553c0000"),I28("01441130c03f00"),I28("00000fffc04000"),
I28("0030d5553cf300"),I28("0304557fcf4000"),I28("03fc31c0345000"),I28("03fc0555fc5500"),
I28("13000c3c045400"),I28("00004030000000"),I28("015553fff15000"),I28("03000c3ffffc00"),
I28("00413055000c00"),I28("03fff155500000"),I28("00555555540000"),I28("005405c0d00000"),
I28("0ccffff5553f00"),I28("01444fc055fc00"),I28("01451555550500"),I28("0fccd313fc0000"),
I28("0004c045540000"),I28("0fc55555505400"),I28("0550d30444c000"),I28("04515555450000"),
I28("03c155503c3000"),I28("014f30d043fc00"),I28("0ff0d555540300"),I28("33f05555440000"),
I28("03015555550000"),I28("04c130d4044000"),I28("001013ff015000"),I28("0404140103fc00"),
I28("03fc4001300100"),I28("03c3fffffcf000"),I28("0cfcc45503fc00"),I28("0c4d15303f0000"),
I28("031003f3400100"),I28("15f0f155c03c00"),I28("05040fff555400"),I28("00f3557fd00000"),
I28("01553f15403f00"),I28("0050011400c000"),I28("00514457f00140"),I28("0cc001544ffc00"),
I28("055154700c3300"),I28("03c004f033c000"),I28("00155555001400"),I28("0043ff5530c000"),
I28("003ffd55441040"),I28("0003fffd414000"),I28("0f300100ccc300"),I28("01510ff1400000"),
I28("04540401555000"),I28("00000001000000"),I28("0344cffcf53c00"),I28("11440003000000"),
I28("0303ffffffc000"),I28("0ff00553f15400"),I28("1530ffd5145000"),I28("04413ffffc0000"),
I28("00000010000400"),I28("05555144c15000"),I28("00c03011555000"),I28("033ff330d15400"),
I28("15554000554000"),I28("0c03fd54f3c000"),I28("0150030c04ff00"),I28("0fc0c3fcc51000"),
I28("0033c55700cc00"),I28("0fc1157f011000"),I28("0fcfcf400c0100"),I28("03c400503c0140"),
I28("01515515514100"),I28("0155d3c4030100"),I28("001557ffc01000"),I28("0c03cffffffc00"),
I28("0000cf55003f00"),I28("0fffffd551cf00"),I28("00555555011000"),I28("01415440550000"),
I28("0fcff04f554c00"),I28("00534300553f00"),I28("05551555550440"),I28("33c00000033000"),
I28("03000055550000"),I28("03115555541540"),I28("01533fc543c000"),I28("0f3f0555501300"),
I28("03f5555fffff00"),I28("0530f04f3ffc00"),I28("3fff0155514000"),I28("03105555000100"),
I28("03c04555544000"),I28("01555450040300"),I28("0150f0ff055400"),I28("01155541403c00"),
I28("0ffd5003d011c0"),I28("103f300f00cf00"),I28("00fff004ffff00"),I28("3c00157cc13000"),
I28("0f1110c5040100"),I28("1533fd57cf3cc0"),I28("05c3ff03355500"),I28("0c734c07f03000"),
I28("00557fd5503f00"),I28("011005cf00c000"),I28("0f105555fc0100"),I28("03c3f154c0ff00"),
I28("0550553f040f00"),I28("0fc3f003000000"),I28("0ffff050350100"),I28("0150ff55cc0000"),
I28("04ffc555533140"),I28("000ffffc511400"),I28("0c00d000000000"),I28("05404ff5430c00"),
I28("01545511555500"),I28("03c400d10c0000"),I28("03c03fff453300"),I28("15544145030000"),
I28("00c030fffffc00"),I28("3fcc055ffd5400"),I28("0503ff14001000"),I28("000403ffff3000"),
I28("0cfffc00300000"),I28("015551f0c41400"),I28("00033fcff04100"),I28("00303155551400"),
I28("15554411515400"),I28("0f00ff54ffc100"),I28("1553ffc5150f00"),I28("3fc0c1c40c4400"),
I28("00c00555514000"),I28("0fc0557fcf0000"),I28("0ff0043100f000"),I28("03c1045cc41100"),
I28("00441555044540"),I28("01550330050000"),I28("010155fc00c000"),I28("010433ffffcf00"),
I28("00f3cfd540ffc0"),I28("0ffffffd544000"),I28("00555534501400"),I28("04c41545101000"),
I28("0ffc000fd55300"),I28("01530550f15000"),I28("15555514555440"),I28("0c3310170f00c0"),
I28("03100515551000"),I28("000155553f3000"),I28("0150fff5700000"),I28("0fffffc00c30c0"),
I28("03c5557fffff00"),I28("054cff50fffc00"),I28("0f333155515400"),I28("0011555500f140"),
I28("00c30055555000"),I28("15005557c0c300"),I28("054ffff1455400"),I28("055555540f0000"),
I28("0ffc5557fc0400"),I28("00cfcc00030f00"),I28("0300c307cfff00"),I28("0f3350f0404300"),
I28("0f5553d400c100"),I28("15433f54ccff00"),I28("15fffd54005400"),I28("0c7d7fd4f00c00"),
I28("00554ffd550000"),I28("00404000000ff0"),I28("0fcf0155ff0000"),I28("00ff0f114c0f00"),
I28("01545531540fc0"),I28("303c0107d35000"),I28("0ffffffffc1100"),I28("0000ffd533c0c0"),
I28("00ffd555544140"),I28("0313fffc500000"),I28("0f0c0400100400"),I28("01130ff541c000"),
I28("05411550544540"),I28("0ffc055440c000"),I28("0ff003ff013c00"),I28("0554d01f300000"),
I28("00c0054fff3000"),I28("0ff1557ffd5500"),I28("0573ff55c05000"),I28("00c003fff0ffc0"),
I28("0fffffc3000000"),I28("0050c0ff0cd400"),I28("3303ffcfffc000"),I28("0014cf15544540"),
I28("155555c1445440"),I28("0fc13f55fffc00"),I28("0553fff5554f00"),I28("03cc0003c00500"),
I28("00cf0355555400"),I28("0c41557ffcc000"),I28("3fff14fd530000"),I28("00111153fc0100"),
I28("14355554100440"),I28("00fcfd15c04000"),I28("054f157fc30000"),I28("0551553ffc3000"),
I28("03ffffc5400f00"),I28("0fffffff510000"),I28("0c505001011000"),I28("04045545500f00"),
I28("0ffc053ff55000"),I28("0550355cfc5400"),I28("05555515551500"),I28("3f03c0c3fff300"),
I28("0c1447d5500f00"),I28("0101155fffcc00"),I28("01433ff5540300"),I28("0fffffffffff00"),
I28("03d5553ffff300"),I28("054cff14000c00"),I28("00113015555400"),I28("0c555554333000"),
I28("00c03ffffc1500"),I28("15440153f3ffc0"),I28("054ffff5540000"),I28("05545554ff0100"),
I28("0fff55543f0000"),I28("0140c011000000"),I28("000c0c0fff3f00"),I28("0f555311044000"),
I28("0f5557c41c4500"),I28("047fff55f30300"),I28("04fffd554fc500"),I28("0d453fd5400000"),
I28("00555ffd555000"),I28("0404003d003c00"),I28("0fcc01553fc000"),I28("000f3f0c151000"),
I28("015015315550c0"),I28("00030ffcc31000"),I28("0fffffffffc000"),I28("00403fd540c000"),
I28("04ff5554105100"),I28("0f00ffff430430"),I28("3fc55141554000"),I28("00040ff5540000"),
I28("054555540c4100"),I28("0fc041550cc000"),I28("0ff043ff453fc0"),I28("05540c53330000"),
I28("03000d54f03300"),I28("0fc5553ffc5500"),I28("00f0c555450000"),I28("000cc0fff33fc0"),
I28("03ff3050407000"),I28("0c0003c433c000"),I28("00103fdffffc00"),I28("014003d5570040"),
I28("055540f0031500"),I28("0f003fc54f3f00"),I28("054fffc55553c0"),I28("0fc3301c134040"),
I28("0030c3f1555400"),I28("0051503ffffc00"),I28("0fc545fc000000"),I28("0c55545fc3f100"),
I28("00ffc14ff00000"),I28("0fffc555441000"),I28("053fd07ccc3c30"),I28("01554555450400"),
I28("0fffc3f1541000"),I28("000045ff155000"),I28("00140435554400"),I28("04c00541440c00"),
I28("0fc1443ffd5400"),I28("0153cc4fff5400"),I28("05515315555400"),I28("3f001ffff3f000"),
I28("001504f13fff00"),I28("000004fffffc00"),I28("014f3ff1510000"),I28("0fffffffffff00"),
I28("031554fffff3c0"),I28("0133ffd54c0000"),I28("01555555555500"),I28("005555570c0f00"),
I28("0000003fffc000"),I28("000cf04fffff00"),I28("0153fff5554000"),I28("043f0555ffc500"),
I28("03ff15547ffc00"),I28("01400fd7ffcc00"),I28("0104405ffccf00"),I28("0d554c45404400"),
I28("005557fdc30540"),I28("00033f55fc0030"),I28("03fffc1543f100"),I28("0155ffcfc04300"),
I28("001553ff554000"),I28("0000005103ff00"),I28("0fff14557fc000"),I28("00554f5fc55000"),
I28("00550031555400"),I28("0010cffff01300"),I28("0ffff03ffff000"),I28("000403c5540000"),
I28("00fc0143c00000"),I28("00cf30fd13c400"),I28("00155550555400"),I28("00cf0ff1501100"),
I28("05400155100000"),I28("0f01c554f03000"),I28("0f0000fd550fc0"),I28("055c3fd7ff0000"),
I28("0c001015100000"),I28("001514ffc15000"),I28("03f0c555444000"),I28("3033f1f1540300"),
I28("00f00514500000"),I28("03f403f04cfc00"),I28("0145f11ffffc00"),I28("015045fd553040"),
I28("0554ffffff1540"),I28("30430ff5510f00"),I28("0153ffc5515f00"),I28("00c0d03c410010"),
I28("0030dfffd55500"),I28("0040ccffcffc00"),I28("001555ffc00100"),I28("0155555ffc3100"),
I28("07fffffffcfc00"),I28("03fc1555055000"),I28("04fc0005533f00"),I28("00040555544500"),
I28("0140c7fc555400"),I28("0155447f345400"),I28("00504035555440"),I28("03ff0130455000"),
I28("015550fd0d5400"),I28("0153fc7ffd5500"),I28("00011415515500"),I28("00031fff3ff100"),
I28("003517fffff3c0"),I28("00ff33ffffff00"),I28("01433ff1400000"),I28("0cfffcffffff00"),
I28("03d54fffc3ff00"),I28("010fffc5545000"),I28("0151153c455500"),I28("0c50554ff0c050"),
I28("00c5055ffff000"),I28("03fff07fffffc0"),I28("0057fcfd510000"),I28("03ffff07ff3100"),
I28("03fff55403f000"),I28("01004fd7ffff00"),I28("01554554ff0c00"),I28("31550cc4045400"),
I28("015555fcf01540"),I28("03ff3f55ffc000"),I28("03fff1c1504000"),I28("0155d7f7105300"),
I28("001550ff5d0000"),I28("00c004455303c0"),I28("03c415554fc000"),I28("01554057f05400"),
I28("00000ff1555500"),I28("015503fff55300"),I28("0cff1133fff000"),I28("00007ff5554000"),
I28("00fc0010ffc400"),I28("013f15354030c0"),I28("0055555f005000"),I28("0000cffc540000"),
I28("0113c314330400"),I28("00f3003ff30000"),I28("0013f031550fc0"),I28("054fffd4c33000"),
I28("00501c05541400"),I28("0154c1ffc00000"),I28("03ff1555553000"),I28("00000435554000"),
I28("000310101430c0"),I28("0ff0c3c543fc00"),I28("0047c157ffff00"),I28("015005ff040000"),
I28("0554ffffffd540"),I28("0d53f3ff545300"),I28("0053fff5510000"),I28("00c0070f000100"),
I28("001013cfc15500"),I28("000003cfccfc00"),I28("0155553f0d0100"),I28("0155555ff30100"),
I28("00ffffffffff00"),I28("03ff1555004000"),I28("000ff3f55fcf00"),I28("00114555555500"),
I28("0c4440ffd55500"),I28("0110033f1c5500"),I28("00440070555500"),I28("00fcf5f0515000"),
I28("015550fc501400"),I28("1553c33fc55500"),I28("03cc0035441540"),I28("045003ff3f1000"),
I28("04000ffffff3c0"),I28("000f33ffffff00"),I28("0140fffd40c300"),I28("0000450cffff00"),
I28("03c550ff003300"),I28("0153fff1555400"),I28("0000543fffc440"),I28("00500d33c00000"),
I28("03fcc057fffc00"),I28("07fff03fffff00"),I28("0155fffc550000"),I28("03fffffffc3000"),
I28("00fff154303000"),I28("054300d5ffff00"),I28("05555555500000"),I28("01543c50005000"),
I28("015555ff0f0510"),I28("0cfd0c557c0100"),I28("03fcf130504000"),I28("01550000c144c0"),
I28("0003413c100000"),I28("00c00515550300"),I28("0ff000557ff000"),I28("00154155c00c00"),
I28("03c150fd555400"),I28("015403ffd55300"),I28("0cc000c30ff000"),I28("004000c4554400"),
I28("157fc4033f0000"),I28("013c15054cf000"),I28("00c55553f00400"),I28("000c0fff144000"),
I28("00000ffffc3000"),I28("000c04ffffcc10"),I28("0f154005541fc0"),I28("047fffd5f0fc00"),
I28("00140c15544000"),I28("055404fc705400"),I28("03cfc55440ff00"),I28("01001145555400"),
I28("0003000557f300"),I28("03ffcfd403fc00"),I28("00130c55ffff00"),I28("0155453fcc0000"),
I28("0555fffcff1500"),I28("0150c0cf045400"),I28("0013fff5503c00"),I28("00045013c05000"),
I28("0007f3fffc5000"),I28("00043f0cc04000"),I28("0155557f440000"),I28("00031553fff040"),
I28("03cc0ccfffff00"),I28("0330051500f100"),I28("000330c5400000"),I28("03c01555545500"),
I28("301110ffc05500"),I28("0010003f100400"),I28("0c030470155500"),I28("070c15fd145140"),
I28("005544fd001500"),I28("0154d0ccc55500"),I28("00f003f3fff000"),I28("00404ffff55500"),
I28("003f33ff3fffc0"),I28("00f3ffffc3fc00"),I28("0103fffc4ff000"),I28("00004440133f00"),
I28("03c0573f314000"),I28("0054ffff455400"),I28("000010fffffc00"),I28("000450ffccc000"),
I28("00cc0014fffc00"),I28("10fff40fc3fc00"),I28("01554ffc541000"),I28("03ff0fffff0000"),
I28("03fffc55f00c00"),I28("0540fc1033ff00"),I28("05555555555000"),I28("0053fc040c5000"),
I28("0155557fff4500"),I28("0ff044155f0000"),I28("00f041cff00100"),I28("0155c454170400"),
I28("053ccc3c401000"),I28("0ff100c5554000"),I28("0fc0430ccfc000"),I28("00ffcc550cfc00"),
I28("0cf044fc515400"),I28("0554043c555400"),I28("03f31300cffc00"),I28("0050ffc7155300"),
I28("1544003030f000"),I28("000055454f0c00"),I28("00f05557fcc400"),I28("0003ffffd11000"),
I28("00003ffffff000"),I28("054543fffcf040"),I28("0cd44435500f00"),I28("013fffd50ccf00"),
I28("00044455451000"),I28("115545fc105400"),I28("0140f5000ffc00"),I28("0000550d540400"),
I28("005000c13fff00"),I28("00cf3f0003cc00"),I28("0017cf550cc300"),I28("014553ffcf0000"),
I28("0555733cff5500"),I28("0d50f0cf155400"),I28("0005ffc1503c00"),I28("0055541ffc1000"),
I28("0f3c03fff30400"),I28("00400fffc14400"),I28("01d5555f7c4000"),I28("00c10043ff3000"),
I28("10f3cfc4ffff00"),I28("030001c5f3f000"),I28("10004005414400"),I28("03fc1555454500"),
I28("005413ffc15500"),I28("0150033f1000c0"),I28("0c0dc430045400"),I28("03c0153c155500"),
I28("0055457d404000"),I28("015017d0fd5400"),I28("000014fffffc00"),I28("04140fffd55500"),
I28("0003003f4fffc0"),I28("000c0cffc0f000"),I28("01103c30501700"),I28("01001000000000"),
I28("03f304fc301400"),I28("0155cfffc44400"),I28("0001c0ff3fff00"),I28("0c5113fff00400"),
I28("00fffc55f00c00"),I28("040ff140113f00"),I28("005553ff551300"),I28("03fc543c33c000"),
I28("000ffc14f03c00"),I28("054c3fd7000000"),I28("05555551555400"),I28("004ccfc5c544c0"),
I28("0011555ffd5500"),I28("03f0441553c000"),I28("00c1054c000f00"),I28("01010fd4d50000"),
I28("053fccfc500000"),I28("00f3413d555100"),I28("0fd540530fc000"),I28("03fff1550f0c00"),
I28("0f0f33ff101500"),I28("010f0431554f00"),I28("0fcc3c3cfffc00"),I28("015f00c3044300"),
I28("1504143303c000"),I28("040005454f0000"),I28("0fcfd555ff1000"),I28("003f0ffff15000"),
I28("03043fcffffc00"),I28("050513ffff0100"),I28("0ff00101400300"),I28("017fffc543c000"),
I28("00005154141000"),I28("0555517f115000"),I28("055031507fff00"),I28("3f011040500500"),
I28("0144413fffff00"),I28("003fc304cff040"),I28("0000ff55040300"),I28("00154ffff0c000"),
I28("04554f3c305540"),I28("3c45400fd55000"),I28("00003ffd543cc0"),I28("00015557ff4500"),
I28("0fccfcfffff000"),I28("004013f3c0c400"),I28("04c54553155100"),I28("0f003003fff000"),
I28("1400331503ff00"),I28("0c105503fff000"),I28("00000401030400"),I28("3fffd551115400"),
I28("0c0000ffc11400"),I28("300003ff003000"),I28("0f3f34fd1503c0"),I28("0000d57d015100"),
I28("0055544c055000"),I28("01500313fd5400"),I28("000c00fffff000"),I28("041557cd555400"),
I28("1140c03f54ff00"),I28("010513ff001400"),I28("01540300455400"),I28("05040111100400"),
I28("03fc05ff040500"),I28("30003fffc0f000"),I28("00cc0fff5ff000"),I28("0f0104fff00000"),
I28("14c00004030040"),I28("0403fd40d54700"),I28("005554ff5d0f00"),I28("03ff157fff0000"),
I28("0543ffc4c30c00"),I28("15500c034c0000"),I28("01551300555500"),I28("0c033ffd555000"),
I28("00551557d55540"),I28("00c0111553c140"),I28("00c1554f3c0f30"),I28("00543f0f1513c0"),
I28("050cf03c401000"),I28("0300073c555500"),I28("03c153133ff000"),I28("04fffc5557c000"),
I28("0f30cc3ffd0cc0"),I28("05404505555300"),I28("00cc43f3fffc00"),I28("015cf030004000"),
I28("141440f11c3c00"),I28("05104155534000"),I28("030fc5550c0000"),I28("0c043c3ffc0500"),
I28("03fc0ff3fff000"),I28("004543ffff1500"),I28("03ff0d454d0c00"),I28("0553ffc44f3000"),
I28("00101415011400"),I28("0555557f005400"),I28("01554153fc0040"),I28("00005500050400"),
I28("0300007ffff000"),I28("000011fccfc540"),I28("00003fd5544000"),I28("0c554ff33ff000"),
I28("0555503ff55500"),I28("031003df151000"),I28("00c00ffd541700"),I28("03ffc157ffc100"),
I28("03fc03fffff300"),I28("00c700fc300140"),I28("05450554100000"),I28("03f00005fffc00"),
I28("0503f355d043c0"),I28("0f41153fff0100"),I28("040000c0101400"),I28("0ffff555455400"),
I28("0fc0043fc00000"),I28("003100ff5cfc00"),I28("3033403005ff00"),I28("000315533d5000"),
I28("00555000054000"),I28("01550f17fc5400"),I28("003330ffff3000"),I28("04105405555400"),
I28("0140cc0d553f00"),I28("0000443ffc1500"),I28("00503031555700"),I28("04000303400000"),
I28("03ff0c7ffc0100"),I28("00414ffff3cc00"),I28("00fcffff50f3c0"),I28("0f1040fff00400"),
I28("15c0015130c140"),I28("0500fc554057c0"),I28("0015554f1050c0"),I28("03ff15c03ff100"),
I28("00104ff030ff00"),I28("1550033f401540"),I28("01553c0fd55500"),I28("003c0cfd5540c0"),
I28("0000f514555100"),I28("0cc0010554c000"),I28("00115414ccfc00"),I28("00513f1fd55fc0"),
I28("043003f1540000"),I28("0001033fd55400"),I28("0303135ffff000"),I28("040fff1555c300"),
I28("0ccff033c10fc0"),I28("01010435551000"),I28("000cc3fffffc00"),I28("0150c033014000"),
I28("045107fd400c00"),I28("000551454c7110"),I28("03fffc55553cc0"),I28("00c0103ff3d000"),
I28("00c00ffdffc400"),I28("0151443f015540"),I28("00fc0005433c00"),I28("015003fd131000"),
I28("00100551000000"),I28("0154010fc03000"),I28("00400053f00d40"),I28("03f00111004100"),
I28("001403fffff140"),I28("045555ffcc5540"),I28("000110f5553f00"),I28("031403f5703000"),
I28("01555500055400"),I28("0f1000000503c0"),I28("003c0ffd5510c0"),I28("03ffff14fff100"),
I28("00fcc013fc0300"),I28("030c00f0400040"),I28("04454555fc7400"),I28("03f01405fff040"),
I28("003cfd14415000"),I28("030c057fff1040"),I28("010c0331115400"),I28("0ffffc55555500"),
I28("03c0114fc00000"),I28("003010fc10cc00"),I28("0ffd0dffffff00"),I28("003dfc53f01400"),
I28("00554001c00100"),I28("010450d7ff5500"),I28("03c303ff031100"),I28("05105505554000"),
I28("01403301554f00"),I28("0144550ff01500"),I28("015511155557c0"),I28("000c01d1000000"),
I28("00f3cc4030c500"),I28("035444fffd0400"),I28("00011040550f00"),I28("03c0473ffc3000"),
I28("04001010cfc500"),I28("0140ff15151400"),I28("00c3340f0003c0"),I28("03ff144d007000"),
I28("0155500f303300"),I28("0554550d555540"),I28("0041000fc55500"),I28("00c3f3fc553fc0"),
I28("003fcf14554000"),I28("005c00115f0440"),I28("000553d533ff00"),I28("00400f5f157cc0"),
I28("014f0001554000"),I28("004734fff55400"),I28("03f3007fffc100"),I28("0543cfd555f100"),
I28("0fff33f4fc13c0"),I28("054c05715500c0"),I28("0145153ffff100"),I28("015500145553c0"),
I28("010005fc530000"),I28("010045141c1140"),I28("03ffff15553f00"),I28("0014400ffcc000"),
I28("00ffffc03fc000"),I28("01411705555540"),I28("0331010553f000"),I28("05550430d55540"),
I28("00111555440000"),I28("0154c4000c0000"),I28("00333c57fc0440"),I28("00c00014101500"),
I28("00000c03ffd550"),I28("01555443015540"),I28("00150105550100"),I28("0003c005513000"),
I28("00555500c55400"),I28("000500141003c0"),I28("0003003d555c00"),I28("03ffcd15fff100"),
I28("00000017fc0000"),I28("03cc0005540140"),I28("00034554ff3030"),I28("03c041c53fcf40"),
I28("010ffc54141000"),I28("0f00057ff11400"),I28("0454d13f155400"),I28("0c030315555500"),
I28("00c0015fcc3c00"),I28("0001013d000000"),I28("03f3333fffff00"),I28("003ffffffcf000"),
I28("0055400c000540"),I28("005c5f14fc5500"),I28("0f0c3fcc0d0400"),I28("04051455550000"),
I28("015cff00554fc0"),I28("00540401011540"),I28("00554455554300"),I28("01000401040000"),
I28("01300401050400"),I28("00011555150400"),I28("00555555570000"),I28("00fc03fff00040"),
I28("01400003331500"),I28("01103fd54100c0"),I28("03f005554c0000"),I28("00ffd4fd044c40"),
I28("00545403f03f00"),I28("01554455555500"),I28("001030f3f15400"),I28("03000cff55c0c0"),
I28("000ff0ffc50000"),I28("00500145400540"),I28("005553f54ffc00"),I28("00100c13d570c0"),
I28("010033c5551500"),I28("001013fff55400"),I28("03c3050fffc400"),I28("000f3001553c00"),
I28("00300fc43f03c0"),I28("00400001500300"),I28("00155553ff0500"),I28("00501c015500c0"),
I28("041430fc1300c0"),I28("0140154f0c0540"),I28("03ffffffffff00"),I28("0000045fffc000"),
I28("000fff00050000"),I28("01000c15555400"),I28("00c0430553ff00"),I28("01555030555500"),
I28("00330555550c00"),I28("0054c0000c0100"),I28("033c3057fc4400"),I28("03f0c000501400"),
I28("00000004015140"),I28("01550404155500"),I28("00150155554100"),I28("00ff0c55413cc0"),
I28("0115543cd55400"),I28("0c314d550c0fc0"),I28("0054c045555300"),I28("00ff01553ff000"),
I28("000041153c0300"),I28("00001405544400"),I28("000fff0fff3000"),I28("03fc0455ffc040"),
I28("0400f000041400"),I28("03c0057f300400"),I28("00550cff155500"),I28("0000133c555000"),
I28("000c0553fff000"),I28("0003000f0cf140"),I28("03f0f33fffffc0"),I28("01fffffffffc00"),
I28("00557c107c0540"),I28("00415117305500"),I28("03cf0fccd40000"),I28("04011151500000"),
I28("004c3f30554300"),I28("00041000450400"),I28("00550405551000"),I28("014500000000c0"),
I28("00040045001100"),I28("00035155540300"),I28("00455555540000"),I28("03fc33f33cd500"),
I28("01010cff315400"),I28("00410fc1410400"),I28("000f0c110c3300"),I28("003ff43d100000"),
I28("00454003003c00"),I28("01545115555500"),I28("00000cfffc4000"),I28("03f3ffff5503c0"),
I28("00fffffffc1000"),I28("045400107c0500"),I28("00557cc140ffc0"),I28("0033fc53d503c0"),
I28("00433fc5540500"),I28("00443c3ff55400"),I28("0000071fc003c0"),I28("01403c3c143c00"),
I28("0303cf343fc3c0"),I28("00505504000400"),I28("01555550551440"),I28("01154c015533c0"),
I28("00003c3c03ffc0"),I28("0005554f0f5540"),I28("00ffffffffff00"),I28("00130044300000"),
I28("0000cc15155300"),I28("00330015550000"),I28("00c00d055ffc00"),I28("005550c1555500"),
I28("00ffffffcf0000"),I28("00151d00cf0100"),I28("03fcf054fc0d00"),I28("03000141400000"),
I28("03300005555540"),I28("00554035455540"),I28("00155515555100"),I28("00ff04550fff00"),
I28("00055033055500"),I28("003c11543cff00"),I28("00001055510300"),I28("000f55457ff000"),
I28("000011454300c0"),I28("00044004411140"),I28("0000fffff0f000"),I28("00fc0555ffc000"),
I28("000c0c01041000"),I28("00f0157ff0c000"),I28("001540cf155400"),I28("0000333fff0000"),
I28("00c01057c00000"),I28("0000c14f00c000"),I28("033f3033ffc0c0"),I28("003fffffffff00"),
I28("00154d451d0500"),I28("0001451fc15400"),I28("03f33fc3001400"),I28("00415550430300"),
I28("0000ff3c413f00"),I28("00001034411100"),I28("00544101470c00"),I28("01500011443300"),
I28("00400004000400"),I28("000c1445000000"),I28("000040d5555400"),I28("00fffccd0fcc00"),
I28("00443c00c15000"),I28("0054033c550100"),I28("003ff0550c3c00"),I28("000ffcc1413f00"),
I28("0001503ccc3000"),I28("00001555555400"),I28("00000cfc003000"),I28("00fccffd540300"),
I28("00ffff03070000"),I28("0014504430c000"),I28("0015404100ffc0"),I28("00cfff53d553c0"),
I28("00413fc1400100"),I28("011000fff15000"),I28("00303c03010000"),I28("050050f0f01000"),
I28("00143cc13ff3c0"),I28("01554551000000"),I28("00545545555440"),I28("0014411140ff00"),
I28("007f3f0f0f3f00"),I28("00001501000140"),I28("0033fccfff3f00"),I28("00055101540000"),
I28("00145550555000"),I28("00033404500c00"),I28("003c14055ffc00"),I28("00555145555500"),
I28("003ffffffff000"),I28("0005400cc00100"),I28("003f3155fff000"),I28("03000015543c00"),
I28("030f0c10140100"),I28("00555555555000"),I28("00005514504400"),I28("03ffc103f3f000"),
I28("001540c5545500"),I28("00033510400c00"),I28("00000015000000"),I28("000055153ff000"),
I28("0001001047c000"),I28("00045100055500"),I28("004fffffc0f000"),I28("000c0003c4f000"),
I28("0000030f714400"),I28("00f0157f0f3c00"),I28("00055554555400"),I28("00040fcfff3000"),
I28("00011154ff3000"),I28("0000001330f000"),I28("0000c155001000"),I28("000fffffffff00"),
I28("00541f00045400"),I28("004151ff115500"),I28("0003fc05414c00"),I28("00555100303c00"),
I28("000fff05543c00"),I28("00003000301000"),I28("00555100400300"),I28("0011030030c000"),
I28("00100101100040"),I28("003c0014000000"),I28("003ffc05510000"),I28("030f3c00000000"),
I28("0100c0cc044000"),I28("00100c3fc01000"),I28("00301411c03000"),I28("0003ff00403300"),
I28("000400cc0f0000"),I28("003f0555555300"),I28("0000003f50cc00"),I28("003ffcc1545300"),
I28("003fff00100f00"),I28("00101140403000"),I28("00550500013f00"),I28("003c0fcc550300"),
I28("0000fc05405400"),I28("000000c4415300"),I28("000034000054c0"),I28("005500cffc14c0"),
I28("00140100cc3f00"),I28("00055430011000"),I28("00455000150400"),I28("00004400000c00"),
I28("000c0c033ffc00"),I28("0001113c3cc040"),I28("00055400f00f00"),I28("0005514155fc00"),
I28("00055555555400"),I28("000f304c03cf00"),I28("0c0c3d443ff000"),I28("00455555454400"),
I28("0030ffffffcf00"),I28("000553fffc4400"),I28("0000f054f00000"),I28("0300503ffff000"),
I28("003c0010541500"),I28("0010155554fc00"),I28("00000050000000"),I28("03ff3fff0fc000"),
I28("00150c54400000"),I28("00c0c515030000"),I28("0000011510c000"),I28("00055550ff0000"),
I28("0050140c53f000"),I28("00011105555540"),I28("0003ffffcc0f00"),I28("00501333c00040"),
I28("00030003c40000"),I28("000c155cc0c100"),I28("00405555555000"),I28("000143033ff000"),
I28("00000505fcf000"),I28("00430c10fcf000"),I28("00044555544000"),I28("0003ffff0cfc00"),
I28("01155473c40400"),I28("0000433f005000"),I28("00440555540000"),I28("0015033c044000"),
I28("003ffc15530000"),I28("00003f00100400"),I28("00155004c0c000"),I28("001400cf030000"),
I28("00000000100100"),I28("000c0040530c00"),I28("003fffff3f1000"),I28("0003c300305400"),
I28("00000c04c10000"),I28("000c3fcfffc000"),I28("003000001cc300"),I28("0003ffc0440400"),
I28("00044030400040"),I28("0033fff000ff00"),I28("000cf3cffc3f00"),I28("0003fc55540000"),
I28("033fc0157c0f00"),I28("0011010540f000"),I28("0005003fc04000"),I28("00cff3f5550f00"),
I28("0000fc15c01000"),I28("00043fc0010000"),I28("00cf0000155000"),I28("01007ffffcc000"),
I28("000505140fff00"),I28("005443cc350000"),I28("00054710515000"),I28("00054000443f00"),
I28("0003f314cff000"),I28("03301000300000"),I28("000555400fccc0"),I28("00003544040f00"),
I28("00015555555400"),I28("00000040cc30c0"),I28("000c01543fc100"),I28("01015155400100"),
I28("0000333fcff000"),I28("000057f0114400"),I28("00000054013000"),I28("0000003ffff000"),
I28("0030fc05155100"),I28("00001155433c00"),I28("00300c01505000"),I28("000cc550503000"),
I28("00103c15410000"),I28("00000010403000"),I28("00001550140c00"),I28("0001400cfcc000"),
I28("005154c3300000"),I28("00010000f0c000"),I28("0003f0cfc00300"),I28("00555150005400"),
I28("00f000f0303000"),I28("0030554f0f0000"),I28("0033cc15000000"),I28("0000401c03f000"),
I28("00554741030000"),I28("004140003cc000"),I28("00004555555400"),I28("00000fffc30000"),
I28("00151504511400"),I28("001553ff005000"),I28("00155555540040"),I28("00003fccc3cc00"),
I28("003cfc4500c000"),I28("0000f004004100"),I28("0000000530cf00"),I28("0003f3413f0000"),
I28("00030005405500"),I28("0033c451003000"),I28("0000f00ffc5000"),I28("00000144555100"),
I28("00105441545000"),I28("000fcf3fffc000"),I28("0000001043c000"),I28("00003f05005400"),
I28("00000c3c0c0000"),I28("000ffffffffc00"),I28("0003fff0331000"),I28("0000fc0540c000"),
I28("00c31554f00c00"),I28("000155440c0c00"),I28("0003ffc1314000"),I28("0033fff5513c00"),
I28("00003071030000"),I28("0010000f140000"),I28("00ffff01555000"),I28("00015550fff000"),
I28("0000133cfffc00"),I28("0000fffffff000"),I28("00000555410000"),I28("0010500003fc00"),
I28("00000003cff000"),I28("000150c0040100"),I28("000100f30fcc00"),I28("00000034113000"),
I28("000c055513f000"),I28("00c00030c00000"),I28("00031d0333c000"),I28("0000011433fc00"),
I28("000fffffffc000"),I28("00030155555000"),I28("00001555550000"),I28("0000fffffff000"),
I28("00000045155000"),I28("00000000cfc000"),I28("00000055504000"),I28("00000555514000"),
I28("00003300410000"),I28("000003ffcc0000"),I28("00000430030000"),I28("00003fcff00000"),
I28("00055551743000"),I28("000000fffff000"),I28("00000555554000"),I28("00015555551400"),
I28("00000405400000"),I28("00015543300000"),I28("000fffffffc000"),I28("00010c0ffff000"),
I28("000451110fc000"),I28("00115544ff0000"),I28("00000055540400"),I28("00003fc0304400"),
I28("00014005403000"),I28("00055ff0030000"),I28("00015555540000"),I28("000103ffffc000"),
I28("00000143ff0000"),I28("00000015554500"),I28("0003fc33fff000"),I28("0000c000010000"),
I28("0000c0f1555000"),I28("00030000000000"),I28("00001555405000"),I28("00055555555500"),
I28("00014555554000"),I28("000ff333300000"),I28("000c3c0c50c000"),I28("00004155140000"),
I28("0000cfc0000000"),I28("0000fffffff000"),I28("00003fc33c0000"),I28("00000c0ff0c000"),
I28("00030543fff000"),I28("0001540c000000"),I28("0000ff04000000"),I28("000fffd5410000"),
I28("00001500000000"),I28("00000014100000"),I28("00000015550000"),I28("000555554ff000"),
I28("00000003000000"),I28("000cfffcffc000"),I28("0000015540c000"),I28("001550000f0c00"),
I28("00015557fff000"),I28("000003cf0c0000"),I28("00040100040000"),I28("00005001310000"),
I28("000ff03cfff000"),I28("00030000000000"),I28("0000ffffcf0000"),I28("000ff0c00cf000"),
I28("000f3ffffc0000"),I28("00003010004000"),I28("00000010410000"),I28("0000303fff3000"),
I28("00000004004000"),I28("00000ff0000000"),I28("00000004000000"),I28("00030000414000"),
I28("0000f004000000"),I28("00000003000000"),I28("00003c00000000"),I28("00000c33000000"),
I28("00015555410000"),I28("0000300fcfc000"),I28("00001155540000"),I28("00015555040000"),
I28("00001151500000"),I28("00000400300000"),I28("000cfffcf00000"),I28("00000333c30000"),
I28("000041440c0000"),I28("0001550fc00000"),I28("00000000000000"),I28("00000000000000"),
I28("000000ccc00000"),I28("0001433ffc0000"),I28("00005444000000"),I28("00003c0c000000"),
I28("0000014440f000"),I28("00005544050000"),I28("000000300c0000"),I28("0000c000000000"),
I28("00000fc1145000"),I28("00000000000000"),I28("00005555550000"),I28("00011415540400"),
I28("00001555440000"),I28("00003000000000"),I28("000c0000000000"),I28("000045400cc000"),
I28("0000003cc00000"),I28("00000003c00000"),I28("0000ccf30c0000"),I28("0000003fc00000"),
I28("0000150ffc0000"),I28("00040000000000"),I28("0000ff30000000"),I28("00003f05000000"),
I28("00000051000000"),I28("00003c30c30000"),I28("00001500040000"),I28("00001555440000"),
I28("00000000100000"),I28("000000c0000000"),I28("00000030000000"),I28("00000000000000"),
I28("00004553fc0000"),I28("00000330000000"),I28("00000114040000"),I28("00000040000000"),
I28("000000030f0000"),I28("00000044400000"),I28("000003f3fc0000"),I28("00000c003c3000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000010000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000c00000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000040000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000c00000000"),I28("00000400000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),I28("00000000000000"),
	};
#pragma HLS array_partition variable=w1 cyclic factor=FL

	static int16_t acc1[FL];
#pragma HLS array_partition variable=acc1

	for (int j = 0; j < FL; j++) {
#pragma HLS unroll
		acc1[j] = 0;
	}

	for (int i = 0; i < H; i++) {
#pragma HLS pipeline
		int2x28_t v1;
		for (int j = 0; j < W; j++) {
#pragma HLS unroll
			ap_int<1> v = in[i * W + j]; // 0:00 1:11
			v1(j * 2 + 1, j * 2) = v;
		}

		for (int j = 0; j < FL; j++) {
#pragma HLS unroll
			int2x28_t mul = v1 & w1[i * FL + j]; // multiply
			acc1[j] += quick_sum(mul); // add
		}
	}

	static int2x64_t w2[CL] = {
I64("553D35C17D571345D55D11DFF5173734"),
I64("755FFF5FDF5535F7FFF7F13D3577DCFD"),
I64("7705577DF4F4C5CD55753FDDD43DF735"),
I64("3CF5DFD7F4C13F41F7D5CFD774F55114"),
I64("DF57C1C7DDCCD3FFC0355C53D377FC4D"),
I64("7C7F5DF5D7C354F75CD775D5FDDD351C"),
I64("D737371C53075F175F7CF47F4FD45F50"),
I64("F55CFCDCDD3F575075D550315F7D5FC4"),
I64("51D0717C45703C0FDDCCDF573F5D171F"),
I64("FFCD7575471DF15DCF5F457341FFFDC7"),
	};
#pragma HLS array_partition variable=w2

	int16_t max = -2000;
	int m = 0;
	for (int i = 0; i < CL; i++) {
#pragma HLS pipeline
		int16_t acc2 = 0;
		for (int j = 0; j < FL; j++) {
#pragma HLS unroll
			int2_t wi = w2[i](j * 2 + 1, j * 2);
			if (acc1[j] > 0) {
				acc2 += wi;
			} else {
				acc2 -= wi;
			}
		}
		if (acc2 > max) {
			max = acc2;
			m = i;
		}
	}
	out[0] = m;
}
